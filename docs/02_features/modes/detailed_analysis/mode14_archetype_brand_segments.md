# モード14 - アーキタイプ分析（ブランド×セグメント）要件定義書

## 最終更新
2025-11-29

---

## 1. 概要

### 1.1 モード名
**モード14**: アーキタイプ分析（ブランド: X=アーキタイプ×セグメント）

### 1.2 モードID
`archetype_brand_segments`

### 1.3 目的
特定のブランドにおいて、複数のセグメント間で**アーキタイプ指標（12タイプ）**を比較し、セグメント別のブランドパーソナリティ認識を評価する。

### 1.4 参照モード
**モード12**（`future_power_brand_segments`）: ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）

### 1.5 モード12との差分
| 項目 | モード12（将来性パワー） | モード14（アーキタイプ） |
|------|---------------------|------------------------|
| **モードID** | `future_power_brand_segments` | `archetype_brand_segments` |
| **分析指標数** | 6項目（FP1～FP6） | 12項目（12タイプのアーキタイプ） |
| **データ取得元** | AJ～AO列（直接取得） | AP～DE列（68項目から計算） |
| **指標の内容** | 将来性を測定する6指標 | ブランドパーソナリティを12タイプで評価 |
| **計算方法** | Excelから直接読み込み | ブランドイメージ項目の平均値から算出 |
| **評価対象** | 将来の成長ポテンシャル | ブランドパーソナリティの認識 |
| **分析項目表記** | 「将来性パワー」 | 「アーキタイプ」 |
| **X軸** | FP1～FP6（将来性パワー） | 12タイプのアーキタイプ |
| **データ系列** | 複数セグメント | 複数セグメント |
| **フィルタ** | 単一ブランド | 単一ブランド |
| **デフォルトチャート** | レーダーチャート | レーダーチャート |

### 1.6 モード13との関係
| 項目 | モード13（セグメント固定） | モード14（ブランド固定） |
|------|-------------------------|------------------------|
| **モードID** | `archetype_segment_brands` | `archetype_brand_segments` |
| **固定軸** | 単一セグメント | 単一ブランド |
| **比較軸** | 複数ブランド | 複数セグメント |
| **分析指標** | 12タイプ（共通） | 12タイプ（共通） |
| **分析視点** | 「セグメント内でブランドを比較」 | 「ブランド内でセグメントを比較」 |

---

## 2. アーキタイプ指標（12タイプ）

### 2.1 指標一覧

| No. | アーキタイプ名 | 英名 | 構成項目数 | 特性 |
|-----|--------------|------|-----------|------|
| 1 | 創造者 | Creator | 5 | 新しい価値を創造する |
| 2 | 統治者 | Ruler | 4 | 分野をけん引する |
| 3 | 賢者 | Sage | 5 | 知性と専門性 |
| 4 | 探検家 | Explorer | 5 | 個性とチャレンジ精神 |
| 5 | 幼子 | Innocent | 5 | 誠実さとピュアさ |
| 6 | 無法者 | Outlaw | 4 | 革新と大胆さ |
| 7 | 魔術師 | Magician | 5 | 革新と夢 |
| 8 | 英雄 | Hero | 5 | 期待と力強さ |
| 9 | 恋人 | Lover | 3 | 感性と魅力 |
| 10 | 道化師 | Jester | 5 | 楽しさと活気 |
| 11 | 仲間 | Regular Guy/Gal | 4 | 親しみやすさ |
| 12 | 援助者 | Caregiver | 5 | 安心と信頼 |

### 2.2 計算方法

**モード13と同じ**: 各アーキタイプの値は、対応するブランドイメージ項目の平均値として算出されます。

```
アーキタイプ値 = Σ(対応項目の値) / 対応項目数
```

---

## 3. 実装仕様

### 3.1 モード設定（constants/analysisConfigs.ts）

```typescript
'archetype_brand_segments': {
  id: 'archetype_brand_segments',
  name: 'アーキタイプ分析（ブランド: X=アーキタイプ×セグメント）',
  description: '単一ブランドにおける複数セグメントのアーキタイプ指標を比較',
  axes: {
    items: {
      role: 'X_AXIS',
      label: '項目',
      allowMultiple: false,
      itemSet: 'archetype',
      fixedItems: [
        'creator', 'ruler', 'sage', 'explorer',
        'innocent', 'outlaw', 'magician', 'hero',
        'lover', 'jester', 'regular', 'caregiver'
      ]
    },
    segments: {
      role: 'SERIES',
      label: 'セグメント',
      allowMultiple: true
    },
    brands: {
      role: 'FILTER',
      label: 'ブランド',
      allowMultiple: false
    }
  },
  dataTransform: {
    xAxis: 'items',
    series: 'segments',
    filter: 'brands'
  },
  defaultChartType: 'radar'
}
```

### 3.2 型定義（types.ts）

**既存の型定義を流用**:
- `ArchetypeMetrics` インターフェース（12タイプ）
- `ARCHETYPE_LABELS` 定数
- `ARCHETYPE_KEYS` 配列
- `ItemSet` 型の `'archetype'`
- `getItemKeysForSet()` および `getItemLabelsForSet()` ヘルパー関数

**追加が必要な型**:
```typescript
export type AnalysisMode =
  | 'funnel_segment_brands'
  | 'funnel_brand_segments'
  | 'funnel_item_segments_brands'
  | 'timeline_brand_segments'
  | 'timeline_segment_brands'
  | 'timeline_item_segments_brands'
  | 'brand_image_segment_brands'
  | 'brand_image_brand_segments'
  | 'brand_power_segment_brands'
  | 'brand_power_brand_segments'
  | 'future_power_segment_brands'
  | 'future_power_brand_segments'
  | 'archetype_segment_brands'
  | 'archetype_brand_segments';  // ← 追加
```

### 3.3 データパース処理

**既存の実装を流用**:
モード13で実装済みの以下の処理を活用：
- `calculateArchetypeMetrics()` 関数
- ExcelParser でのアーキタイプメトリクス計算
- dataTransforms.ts でのアーキタイプデータ抽出

---

## 4. UI/UX仕様

### 4.1 UI要素の配置

#### モード選択エリア
- **モード選択ドロップダウン**: 「アーキタイプ分析（ブランド: X=アーキタイプ×セグメント）」

#### 軸選択エリア
1. **ブランド選択**（フィルタ）
   - ラベル: 「ブランド」
   - 単一選択（ドロップダウン）
   - 必須選択

2. **セグメント選択**（データ系列）
   - ラベル: 「セグメント」
   - 複数選択可能（チェックボックス）
   - ドラッグ&ドロップで並び替え可能
   - 最低1つ選択必須

3. **分析項目**（X軸）
   - 12タイプのアーキタイプ（固定）
   - ユーザー選択不可（自動設定）

#### グラフエリア
- **デフォルトチャートタイプ**: レーダーチャート
- **切り替え可能なチャート**: 縦棒グラフ、横棒グラフ、折れ線グラフ
- **データラベル**: 表示/非表示切り替え可能
- **凡例**: セグメント名を表示

#### データテーブル
- **行ラベル**: アーキタイプ名（日本語）
  - 創造者、統治者、賢者、探検家、幼子、無法者、魔術師、英雄、恋人、道化師、仲間、援助者
- **列ラベル**: セグメント名
- **データ**: 各セルに数値表示

---

## 5. ビジネス価値

### 5.1 分析の目的
1. **セグメント別パーソナリティ評価**: 特定ブランドが各セグメントでどのように認識されているか評価
2. **セグメント戦略の最適化**: どのセグメントでパーソナリティ強化が必要か特定
3. **セグメント間のギャップ把握**: パーソナリティ認識の強いセグメントと弱いセグメントを可視化

### 5.2 想定ユースケース

#### ユースケース1: セグメント別パーソナリティ診断
**シナリオ**: 自社ブランドAのパーソナリティを若年層・中年層・シニア層で比較
- **操作**: モード14選択 → ブランドA選択 → 3セグメント選択
- **発見**: 若年層では「探検家」「魔術師」が高評価だが、シニア層では「援助者」「幼子」が高い
- **アクション**: セグメント別にコミュニケーション戦略を調整

#### ユースケース2: パーソナリティの偏りを発見
**シナリオ**: ブランドBが全セグメントで均等にパーソナリティを持つか確認
- **操作**: モード14選択 → ブランドB選択 → 全セグメント選択
- **発見**: レーダーチャートで一部セグメントのみ形状が歪んでいる
- **アクション**: 弱いセグメント向けのパーソナリティ施策を強化

#### ユースケース3: モード13との併用分析
**シナリオ**: セグメント内ブランド比較（モード13）とブランド内セグメント比較（モード14）を併用
- **操作**:
  1. モード13で「全体セグメント」における3ブランドのパーソナリティを比較
  2. モード14で「ブランドA」における3セグメントのパーソナリティを比較
- **発見**: ブランドAは全体で強いが、特定セグメントでは弱い
- **アクション**: セグメント特化型のパーソナリティ施策を立案

---

## 6. 実装ステップ

### Phase 1: 型定義の拡張（types.ts）
- [x] **既にモード13で完了**: `ArchetypeMetrics` インターフェース
- [x] **既にモード13で完了**: `ARCHETYPE_LABELS` 定数
- [x] **既にモード13で完了**: `ARCHETYPE_KEYS` 定数
- [x] `AnalysisMode` 型に `'archetype_brand_segments'` を追加

### Phase 2: モード設定の追加（constants/analysisConfigs.ts）
- [x] `archetype_brand_segments` モード設定を追加
  - X軸: 12タイプのアーキタイプ（固定12項目）
  - データ系列: 複数セグメント
  - フィルタ: 単一ブランド
  - デフォルトチャート: レーダーチャート
- [x] `ANALYSIS_MODE_ORDER` 配列に `'archetype_brand_segments'` を追加

### Phase 3: データパース処理の確認
- [x] **既にモード13で完了**: `calculateArchetypeMetrics()` 関数
- [x] **既にモード13で完了**: ExcelParser でのアーキタイプメトリクス計算
- [x] **既にモード13で完了**: dataTransforms.ts でのアーキタイプデータ抽出
- **確認のみでOK**: パース処理はモード13と共通

### Phase 4: 動作確認
- [ ] データ読み込み
- [ ] セグメント選択（複数選択）
- [ ] ブランド選択（単一選択）
- [ ] レーダーチャートのデフォルト表示
- [ ] グラフタイプ切り替え
- [ ] データラベル表示/非表示
- [ ] CSV出力
- [ ] PNG画像コピー
- [ ] ドラッグ&ドロップでセグメント並び替え

---

## 7. まとめ

### 実装の要点
1. **モード12のコピー&修正**: モード12の設定をコピーし、`futurePower` → `archetype` に変更
2. **データパース処理は流用**: モード13で既に実装済みのため追加実装不要
3. **型定義は流用**: モード13で既に実装済みのため追加実装不要
4. **効率的な実装**: 最小限の変更で最大の効果

### モード14の位置づけ
- **モード13-14の体系**:
  - モード13: セグメント固定 × 12タイプアーキタイプ × 複数ブランド
  - モード14: ブランド固定 × 12タイプアーキタイプ × 複数セグメント ← 今回実装

### ビジネス価値
- **セグメント別のパーソナリティ評価**: 特定ブランドがどのセグメントでどのように認識されているか明確化
- **モード13との補完**: ブランド比較とセグメント比較の両方の視点を提供
- **ターゲット戦略**: セグメント別の認識に応じたコミュニケーション戦略を立案

---

**文書ステータス**: 要件定義完了  
**作成日**: 2025-11-29  
**バージョン**: 1.0  
**次のステップ**: 実装完了、動作確認

