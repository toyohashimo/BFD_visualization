# éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ å®Ÿè£…ã‚¬ã‚¤ãƒ‰ï¼ˆMode 1-5å®Ÿè£…å®Œäº†ç‰ˆï¼‰

## ğŸ“‹ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ¦‚è¦

**æœ€çµ‚æ›´æ–°æ—¥**: 2025-11-30  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: Mode 1-5 å®Œäº†ã€Mode 6-14 å®Ÿè£…å¾…ã¡  
**å¯¾è±¡èª­è€…**: æ¬¡ã®ãƒ¢ãƒ¼ãƒ‰å®Ÿè£…æ‹…å½“è€…ï¼ˆAI/é–‹ç™ºè€…ï¼‰

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ Mode 1-5ã®å®Ÿè£…çµŒé¨“ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸçŸ¥è¦‹ã‚’ä½“ç³»åŒ–ã—ã€Mode 6-14ã®åŠ¹ç‡çš„ãªå®Ÿè£…ã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã®ç·åˆã‚¬ã‚¤ãƒ‰ã§ã™ã€‚

---

## ğŸ¯ å®Ÿè£…æ¸ˆã¿ãƒ¢ãƒ¼ãƒ‰ä¸€è¦§

| ãƒ¢ãƒ¼ãƒ‰ | ãƒ¢ãƒ¼ãƒ‰ID | ãƒ¢ãƒ¼ãƒ‰å | å®Ÿè£…æ—¥ | å®Ÿè£…æ™‚é–“ | ãƒ‘ã‚¿ãƒ¼ãƒ³ | çŠ¶æ…‹ |
|-------|---------|---------|-------|---------|---------|------|
| **Mode 1** | `historical_funnel1_segment_brand` | ãƒ•ã‚¡ãƒãƒ«åˆ†æâ‘ ï¼ˆéå»æ¯”è¼ƒï¼‰ | 2025-11-30 | 3æ—¥ | åŸºç›¤æ§‹ç¯‰ | âœ… å®Œäº† |
| **Mode 2** | `historical_funnel2_segment_brand` | ãƒ•ã‚¡ãƒãƒ«åˆ†æâ‘¡ï¼ˆéå»æ¯”è¼ƒï¼‰ | 2025-11-30 | 5åˆ† | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | âœ… å®Œäº† |
| **Mode 3** | `historical_brand_image_segment_brand` | ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æï¼ˆéå»æ¯”è¼ƒï¼‰ | 2025-11-30 | 35åˆ† | ãƒ‘ã‚¿ãƒ¼ãƒ³2 | âœ… å®Œäº† |
| **Mode 4** | `historical_brand_power_segment_brand` | ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘ ï¼ˆéå»æ¯”è¼ƒï¼‰ | 2025-11-30 | 3åˆ† | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | âœ… å®Œäº† |
| **Mode 5** | `historical_future_power_segment_brand` | ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘¡ï¼ˆéå»æ¯”è¼ƒï¼‰ | 2025-11-30 | 10åˆ† | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | âœ… å®Œäº† |

### å®Ÿè£…æ™‚é–“ã®æ¨ç§»

```
Mode 1: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 3æ—¥ï¼ˆåŸºç›¤æ§‹ç¯‰ï¼‰
Mode 2: â–ˆ 5åˆ†ï¼ˆè¨­å®šã®ã¿ï¼‰
Mode 3: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 35åˆ†ï¼ˆå‹•çš„é …ç›®ï¼‰
Mode 4: â–ˆ 3åˆ†ï¼ˆè¨­å®šã®ã¿ï¼‰
Mode 5: â–ˆâ–ˆ 10åˆ†ï¼ˆè¨­å®šã®ã¿ï¼‰
```

**é‡è¦ãªç™ºè¦‹**: å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå®Œå…¨ã«ç¢ºç«‹ï¼Mode 4-5ã§é«˜é€Ÿå®Ÿè£…ãŒå®Ÿè¨¼ã•ã‚Œã¾ã—ãŸã€‚

---

## ğŸ“Š å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã®åˆ†é¡

### ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†é¡è¡¨

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | ç‰¹å¾´ | å®Ÿè£…æ™‚é–“ | æ–°è¦ã‚³ãƒ¼ãƒ‰é‡ | ã‚¨ãƒ©ãƒ¼ç‡ | è©²å½“ãƒ¢ãƒ¼ãƒ‰ |
|---------|------|---------|------------|---------|----------|
| **åŸºç›¤æ§‹ç¯‰** | æœ€åˆã®å®Ÿè£…ã€ã™ã¹ã¦ã®åŸºç›¤ã‚’æ§‹ç¯‰ | 3æ—¥ | ç´„1000è¡Œ | - | Mode 1 |
| **ãƒ‘ã‚¿ãƒ¼ãƒ³1** | å›ºå®šé …ç›®ã€è¨­å®šè¿½åŠ ã®ã¿ | **3-5åˆ†** | ç´„30è¡Œ | 0% | Mode 2, 4-6, 9-14 |
| **ãƒ‘ã‚¿ãƒ¼ãƒ³2** | å‹•çš„é …ç›®ã€å°‚ç”¨é–¢æ•°å®Ÿè£… | **30-35åˆ†** | ç´„150è¡Œ | <5% | Mode 3, 7-8 |

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: å›ºå®šé …ç›®ãƒ¢ãƒ¼ãƒ‰ï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰â­

#### ç‰¹å¾´
- âœ… Xè»¸é …ç›®ãŒå›ºå®šï¼ˆä¾‹: FT, FW, FZ... ã‚„ BP1-BP4ï¼‰
- âœ… æ—¢å­˜ã®`transformDataForHistoricalChart`é–¢æ•°ã‚’ãã®ã¾ã¾ä½¿ç”¨
- âœ… è¨­å®šè¿½åŠ ã®ã¿ã§å®Ÿè£…å®Œäº†
- âœ… æ–°è¦ã‚³ãƒ¼ãƒ‰0è¡Œ

#### å®Ÿè£…æ‰‹é †ï¼ˆ3-5åˆ†ï¼‰
1. **å‹å®šç¾©ã«è¿½åŠ ** (`src/types/analysis.ts`) - 30ç§’
2. **ãƒ¢ãƒ¼ãƒ‰è¨­å®šè¿½åŠ ** (`constants/analysisConfigs.ts`) - 2åˆ†
3. **ãƒ¢ãƒ¼ãƒ‰é¸æŠé †åºã«è¿½åŠ ** (`HISTORICAL_ANALYSIS_MODE_ORDER`) - 30ç§’
4. **ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯** - 30ç§’

#### è©²å½“ãƒ¢ãƒ¼ãƒ‰
- âœ… **Mode 2**: ãƒ•ã‚¡ãƒãƒ«åˆ†æâ‘¡ï¼ˆå®Œäº†ï¼‰
- âœ… **Mode 4**: ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘ ï¼ˆå®Œäº†ï¼‰
- âœ… **Mode 5**: ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘¡ï¼ˆå®Œäº†ï¼‰
- â¸ï¸ **Mode 6-14**: ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã€ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—åˆ†æç­‰

#### å®Ÿè£…ä¾‹ï¼ˆMode 4ã‚’å‚è€ƒï¼‰

```typescript
// constants/analysisConfigs.ts
'historical_brand_power_segment_brand': {
    id: 'historical_brand_power_segment_brand',
    name: 'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘ ï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€ãƒ–ãƒ©ãƒ³ãƒ‰: X=ç¾åœ¨ãƒ‘ãƒ¯ãƒ¼Ã—éå»æ¯”è¼ƒï¼‰',
    description: 'å˜ä¸€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ»å˜ä¸€ãƒ–ãƒ©ãƒ³ãƒ‰ã«ãŠã‘ã‚‹éå»ãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒï¼ˆãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼ï¼‰',
    axes: {
        items: {
            role: 'X_AXIS',
            label: 'é …ç›®',
            allowMultiple: false,
            itemSet: 'brandPower',  // â† é …ç›®ã‚»ãƒƒãƒˆ
            fixedItems: ['BP1', 'BP2', 'BP3', 'BP4']  // â† å›ºå®šé …ç›®
        },
        segments: {
            role: 'FILTER',
            label: 'ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ',
            allowMultiple: false  // éå»æ¯”è¼ƒã§ã¯å¿…ãšfalse
        },
        brands: {
            role: 'FILTER',
            label: 'ãƒ–ãƒ©ãƒ³ãƒ‰',
            allowMultiple: false  // éå»æ¯”è¼ƒã§ã¯å¿…ãšfalse
        }
    },
    dataTransform: {
        xAxis: 'items',
        series: 'dataSources',  // å¿…ãš 'dataSources'
        filter: 'segments'
    },
    defaultChartType: 'radar'  // 'bar', 'line', 'radar'ã‹ã‚‰é¸æŠ
}
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: å‹•çš„é …ç›®ãƒ¢ãƒ¼ãƒ‰ï¼ˆå°‘ã—è¤‡é›‘ï¼‰âš ï¸

#### ç‰¹å¾´
- âš ï¸ Xè»¸é …ç›®ãŒå‹•çš„ï¼ˆä¾‹: ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã®TOP30ï¼‰
- âš ï¸ å°‚ç”¨ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›é–¢æ•°ãŒå¿…è¦
- âš ï¸ åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®æ¦‚å¿µãŒå¿…è¦
- âš ï¸ UIè­¦å‘Šã®å®Ÿè£…ãŒå¿…è¦

#### å®Ÿè£…æ‰‹é †ï¼ˆ30-35åˆ†ï¼‰
1. **å‹å®šç¾©ã«è¿½åŠ ** - 1åˆ†
2. **ãƒ¢ãƒ¼ãƒ‰è¨­å®šè¿½åŠ ** (`autoSelect: true`) - 3åˆ†
3. **å°‚ç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›é–¢æ•°ã®å®Ÿè£…** - 20åˆ†
4. **App.tsxã§åˆ†å²è¿½åŠ ** - 5åˆ†
5. **UIè­¦å‘Šã®å®Ÿè£…** - 5åˆ†
6. **ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯** - 2åˆ†

#### è©²å½“ãƒ¢ãƒ¼ãƒ‰
- âœ… **Mode 3**: ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æï¼ˆå®Œäº†ï¼‰
- â¸ï¸ **Mode 7-8**: ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆâ†”ãƒ–ãƒ©ãƒ³ãƒ‰å…¥ã‚Œæ›¿ãˆï¼‰

#### å®Ÿè£…ä¾‹ï¼ˆMode 3ã‚’å‚è€ƒï¼‰

```typescript
// constants/analysisConfigs.ts
'historical_brand_image_segment_brand': {
    id: 'historical_brand_image_segment_brand',
    name: 'ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€ãƒ–ãƒ©ãƒ³ãƒ‰: X=ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸Ã—éå»æ¯”è¼ƒï¼‰',
    axes: {
        items: {
            role: 'X_AXIS',
            itemSet: 'brandImage',
            fixedItems: [],          // â† ç©ºé…åˆ—
            autoSelect: true,        // â† å‹•çš„é¸å®šã‚’æœ‰åŠ¹åŒ–
            autoSelectCount: 30      // â† TOP30ã‚’é¸å®š
        },
        // ... ä»–ã®è¨­å®š
    }
}
```

---

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å…¨ä½“åƒ

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ                                        â”‚
â”‚ - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæœ€å¤§3ã¤ï¼‰                   â”‚
â”‚ - ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆï¼ˆè©³ç´°åˆ†æ â‡” éå»æ¯”è¼ƒï¼‰  â”‚
â”‚ - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰é¸æŠï¼ˆSAåˆ¶ç´„ï¼‰                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç† (useMultiDataSource)              â”‚
â”‚ - dataSources: DataSource[]ï¼ˆæœ€å¤§3ã¤ï¼‰             â”‚
â”‚ - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ã¿LocalStorageã«ä¿å­˜                 â”‚
â”‚ - å®Ÿãƒ‡ãƒ¼ã‚¿ã¯ãƒ¡ãƒ¢ãƒªã«ä¿æŒï¼ˆuseRefï¼‰                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰ç®¡ç† (useGlobalMode)                â”‚
â”‚ - globalMode: 'detailed' | 'historical'           â”‚
â”‚ - ãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ãŸè¨­å®šåˆ‡ã‚Šæ›¿ãˆ                        â”‚
â”‚ - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ã®SAåˆ¶ç´„é©ç”¨                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App.tsx: chartDataç”Ÿæˆ                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ if (isHistoricalMode()) {                      â”‚ â”‚
â”‚ â”‚   if (itemSet === 'brandImage' && autoSelect) â”‚ â”‚
â”‚ â”‚     â†’ transformDataForHistoricalBrandImage    â”‚ â”‚
â”‚ â”‚   else                                         â”‚ â”‚
â”‚ â”‚     â†’ transformDataForHistoricalChart         â”‚ â”‚
â”‚ â”‚ }                                              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ChartArea: ã‚°ãƒ©ãƒ•ãƒ»ãƒ†ãƒ¼ãƒ–ãƒ«æç”»                     â”‚
â”‚ - seriesItems: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åï¼ˆå‡¡ä¾‹ï¼‰              â”‚
â”‚ - xAxisKeys: é …ç›®ã‚­ãƒ¼ï¼ˆXè»¸ï¼‰                       â”‚
â”‚ - chartType: bar, line, radar                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
excel_visualization2/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ analysis.ts          âœ… AnalysisModeå‹å®šç¾©ï¼ˆé‡è¦ï¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ dataSource.ts        âœ… DataSourceå‹å®šç¾©
â”‚   â”‚   â””â”€â”€ globalMode.ts        âœ… GlobalModeå‹å®šç¾©
â”‚   â””â”€â”€ hooks/
â”‚       â”œâ”€â”€ useMultiDataSource.ts  âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†
â”‚       â””â”€â”€ useGlobalMode.ts       âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰ç®¡ç†
â”œâ”€â”€ constants/
â”‚   â””â”€â”€ analysisConfigs.ts       âœ… ãƒ¢ãƒ¼ãƒ‰è¨­å®šï¼ˆæœ€é‡è¦ï¼ï¼‰
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ dataTransforms.ts        âœ… ãƒ‡ãƒ¼ã‚¿å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ GlobalModeTab.tsx        âœ… ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆã‚¿ãƒ–
â”‚   â”œâ”€â”€ DataSourceManager.tsx    âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†UI
â”‚   â”œâ”€â”€ Sidebar.tsx              âœ… ã‚µã‚¤ãƒ‰ãƒãƒ¼çµ±åˆ
â”‚   â””â”€â”€ ChartArea.tsx            âœ… ã‚°ãƒ©ãƒ•æç”»
â””â”€â”€ docs/
    â”œâ”€â”€ HISTORICAL_COMPARISON_REQUIREMENTS.md
    â”œâ”€â”€ HISTORICAL_MODE1_IMPLEMENTATION_REPORT.md
    â”œâ”€â”€ HISTORICAL_MODE2_IMPLEMENTATION_REPORT.md
    â”œâ”€â”€ HISTORICAL_MODE3_IMPLEMENTATION_REPORT.md
    â”œâ”€â”€ HISTORICAL_MODE4_REQUIREMENTS.md
    â”œâ”€â”€ HISTORICAL_MODE4_IMPLEMENTATION_REPORT.md
    â””â”€â”€ HISTORICAL_MODES_IMPLEMENTATION_GUIDE.md â† æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
```

---

## ğŸ”§ å®Ÿè£…ã®è©³ç´°æ‰‹é †ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³1ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—1: å‹å®šç¾©ã®è¿½åŠ ï¼ˆ30ç§’ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«: `src/types/analysis.ts`

```typescript
export type AnalysisMode =
  | ''
  // è©³ç´°åˆ†æãƒ¢ãƒ¼ãƒ‰
  | 'segment_x_multi_brand'
  // ... ä»–ã®ãƒ¢ãƒ¼ãƒ‰ ...
  // éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰
  | 'historical_funnel1_segment_brand'
  | 'historical_funnel2_segment_brand'
  | 'historical_brand_image_segment_brand'
  | 'historical_brand_power_segment_brand'
  | 'historical_YOUR_NEW_MODE';  // â† è¿½åŠ 
```

**ãƒã‚¤ãƒ³ãƒˆ**:
- âœ… å‹å®šç¾©ã«è¿½åŠ ã™ã‚‹ã ã‘ã§TypeScriptã®æ©æµã‚’å—ã‘ã‚‰ã‚Œã‚‹
- âœ… ã‚¿ã‚¤ãƒã‚„è¨­å®šãƒŸã‚¹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æ¤œå‡º

### ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ¢ãƒ¼ãƒ‰è¨­å®šã®è¿½åŠ ï¼ˆ2åˆ†ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«: `constants/analysisConfigs.ts`

```typescript
export const HISTORICAL_ANALYSIS_MODE_CONFIGS: Record<string, AnalysisModeConfig> = {
    // æ—¢å­˜ãƒ¢ãƒ¼ãƒ‰...
    
    'historical_YOUR_NEW_MODE': {
        id: 'historical_YOUR_NEW_MODE',
        name: 'XXXåˆ†æï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆã€ãƒ–ãƒ©ãƒ³ãƒ‰: X=XXXÃ—éå»æ¯”è¼ƒï¼‰',
        description: 'å˜ä¸€ã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ»å˜ä¸€ãƒ–ãƒ©ãƒ³ãƒ‰ã«ãŠã‘ã‚‹éå»ãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒ',
        axes: {
            items: {
                role: 'X_AXIS',
                label: 'é …ç›®',
                allowMultiple: false,
                itemSet: 'YOUR_ITEM_SET',  // 'funnel', 'timeline', 'brandPower', 'futurePower', 'archetype'
                fixedItems: ['ITEM1', 'ITEM2', 'ITEM3', 'ITEM4']  // å›ºå®šé …ç›®ãƒªã‚¹ãƒˆ
            },
            segments: {
                role: 'FILTER',
                label: 'ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ',
                allowMultiple: false  // éå»æ¯”è¼ƒã§ã¯å¿…ãšfalse
            },
            brands: {
                role: 'FILTER',
                label: 'ãƒ–ãƒ©ãƒ³ãƒ‰',
                allowMultiple: false  // éå»æ¯”è¼ƒã§ã¯å¿…ãšfalse
            }
        },
        dataTransform: {
            xAxis: 'items',
            series: 'dataSources',  // å¿…ãš 'dataSources'
            filter: 'segments'
        },
        defaultChartType: 'bar'  // 'bar', 'line', 'radar'
    }
};
```

**é‡è¦ãªè¨­å®šé …ç›®**:

| é …ç›® | å¿…é ˆå€¤ | èª¬æ˜ |
|-----|-------|------|
| `allowMultiple` | `false` | éå»æ¯”è¼ƒã§ã¯å¿…ãšå˜ä¸€é¸æŠ |
| `series` | `'dataSources'` | ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒç³»åˆ—ã«ãªã‚‹ |
| `role` | `'X_AXIS'`, `'FILTER'` | items=Xè»¸ã€segments/brands=ãƒ•ã‚£ãƒ«ã‚¿ |
| `itemSet` | é©åˆ‡ãªå€¤ | ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«åˆã‚ã›ã¦é¸æŠ |
| `fixedItems` | é …ç›®ã‚­ãƒ¼é…åˆ— | Xè»¸ã«è¡¨ç¤ºã™ã‚‹é …ç›® |
| `defaultChartType` | ãƒãƒ£ãƒ¼ãƒˆã‚¿ã‚¤ãƒ— | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¡¨ç¤ºå½¢å¼ |

### ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ¢ãƒ¼ãƒ‰é¸æŠé †åºã¸ã®è¿½åŠ ï¼ˆ30ç§’ï¼‰

```typescript
export const HISTORICAL_ANALYSIS_MODE_ORDER = [
    'historical_funnel1_segment_brand',
    'historical_funnel2_segment_brand',
    'historical_brand_image_segment_brand',
    'historical_brand_power_segment_brand',
    'historical_YOUR_NEW_MODE'  // â† è¿½åŠ 
];
```

**ãƒã‚¤ãƒ³ãƒˆ**:
- âœ… ã“ã®é…åˆ—ã®é †åºã§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã«è¡¨ç¤ºã•ã‚Œã‚‹
- âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¨ã£ã¦åˆ†ã‹ã‚Šã‚„ã™ã„é †åºã«ã™ã‚‹

### ã‚¹ãƒ†ãƒƒãƒ—4: ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯ï¼ˆ30ç§’ï¼‰

```typescript
// ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ
read_lints(['constants/analysisConfigs.ts', 'src/types/analysis.ts'])
```

**æœŸå¾…çµæœ**: ã‚¨ãƒ©ãƒ¼0ä»¶ âœ…

---

## ğŸ”§ å®Ÿè£…ã®è©³ç´°æ‰‹é †ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³2ï¼‰

### ã‚¹ãƒ†ãƒƒãƒ—1-3: ãƒ‘ã‚¿ãƒ¼ãƒ³1ã¨åŒã˜

**é•ã„**: `autoSelect: true`ã¨`fixedItems: []`ã‚’è¨­å®š

```typescript
items: {
    role: 'X_AXIS',
    itemSet: 'brandImage',
    fixedItems: [],          // â† ç©ºé…åˆ—
    autoSelect: true,        // â† å‹•çš„é¸å®šã‚’æœ‰åŠ¹åŒ–
    autoSelectCount: 30      // â† é¸å®šæ•°
}
```

### ã‚¹ãƒ†ãƒƒãƒ—4: å°‚ç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›é–¢æ•°ã®å®Ÿè£…ï¼ˆ20åˆ†ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«: `utils/dataTransforms.ts`

```typescript
/**
 * éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ - XXXåˆ†æç”¨ã®ãƒ‡ãƒ¼ã‚¿å¤‰æ›
 */
export const transformDataForHistoricalYourNewMode = (
    dataSources: Array<{
        id: string;
        name: string;
        data: SheetData;
        yourData?: YourData;
        isActive: boolean;
    }>,
    config: AnalysisModeConfig,
    selectedSegment: string,
    selectedBrand: string,
    labelGetters: Record<AxisType, (key: string) => string>,
    yourData?: YourData
): ChartDataPoint[] | null => {
    
    // 1. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’ãƒ•ã‚£ãƒ«ã‚¿
    const activeSources = dataSources.filter(ds => ds.isActive);
    if (activeSources.length === 0) {
        console.warn('[Historical YourMode] ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“');
        return null;
    }
    
    // 2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    if (!selectedSegment || !selectedBrand) {
        console.warn('[Historical YourMode] ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¾ãŸã¯ãƒ–ãƒ©ãƒ³ãƒ‰ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“');
        return null;
    }
    
    // 3. åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰TOPné …ç›®ã‚’é¸å®š
    const referenceSource = activeSources[0];
    const topNItems = selectTopNItems(
        referenceSource,
        selectedSegment,
        selectedBrand,
        config.axes.items?.autoSelectCount || 30
    );
    
    if (topNItems.length === 0) {
        console.warn('[Historical YourMode] TOPé …ç›®ãŒé¸å®šã§ãã¾ã›ã‚“ã§ã—ãŸ');
        return null;
    }
    
    console.log(`[Historical YourMode] TOP${topNItems.length}é …ç›®ã‚’é¸å®šã—ã¾ã—ãŸ`, topNItems);
    
    // 4. å„é …ç›®ã”ã¨ã«ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã‚’ç”Ÿæˆ
    const chartData: ChartDataPoint[] = topNItems.map(itemName => {
        const dataPoint: ChartDataPoint = { name: itemName };
        
        // 5. å„ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®å€¤ã‚’å–å¾—
        activeSources.forEach(source => {
            const value = extractValue(source, selectedSegment, selectedBrand, itemName);
            dataPoint[source.name] = value ?? 0;
        });
        
        return dataPoint;
    });
    
    return chartData;
};

/**
 * TOPné …ç›®ã‚’é¸å®šã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
 */
function selectTopNItems(
    source: DataSource,
    segment: string,
    brand: string,
    count: number
): string[] {
    // å®Ÿè£…: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰å€¤ã‚’å–å¾—ã—ã¦é™é †ã‚½ãƒ¼ãƒˆ
    // Mode 3ã®å®Ÿè£…ã‚’å‚è€ƒã«ã™ã‚‹
    return [];
}

/**
 * å€¤ã‚’æŠ½å‡ºã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
 */
function extractValue(
    source: DataSource,
    segment: string,
    brand: string,
    itemName: string
): number | undefined {
    // å®Ÿè£…: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰ç‰¹å®šã®å€¤ã‚’æŠ½å‡º
    // Mode 3ã®å®Ÿè£…ã‚’å‚è€ƒã«ã™ã‚‹
    return undefined;
}
```

### ã‚¹ãƒ†ãƒƒãƒ—5: App.tsxã§åˆ†å²è¿½åŠ ï¼ˆ5åˆ†ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«: `App.tsx`

```typescript
// importæ–‡ã«è¿½åŠ 
import { 
    transformDataForChart, 
    transformDataForHistoricalChart,
    transformDataForHistoricalBrandImage,
    transformDataForHistoricalYourNewMode  // â† è¿½åŠ 
} from './utils/dataTransforms';

// chartDataç”Ÿæˆéƒ¨åˆ†ï¼ˆ350è¡Œç›®ã‚ãŸã‚Šï¼‰
const chartData = useMemo(() => {
    const config = currentModeConfigs[analysisMode];
    if (!config || !config.axes) return null;

    // ... labelGetterså®šç¾© ...

    // éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã®å ´åˆ
    if (isHistoricalMode()) {
        const activeSources = getActiveDataSources();
        if (activeSources.length === 0) return null;

        // ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æã®å ´åˆ
        if (config.axes.items?.itemSet === 'brandImage' && config.axes.items?.autoSelect) {
            return transformDataForHistoricalBrandImage(
                activeSources,
                config,
                sheet,
                targetBrand,
                labelGetters,
                brandImageData
            );
        }

        // YOUR_NEW_MODE ã®å ´åˆï¼ˆè¿½åŠ ï¼‰
        if (config.axes.items?.itemSet === 'YOUR_ITEM_SET' && config.axes.items?.autoSelect) {
            return transformDataForHistoricalYourNewMode(
                activeSources,
                config,
                sheet,
                targetBrand,
                labelGetters,
                yourData
            );
        }

        // ãã®ä»–ã®å›ºå®šé …ç›®ãƒ¢ãƒ¼ãƒ‰
        return transformDataForHistoricalChart(
            activeSources,
            config,
            sheet,
            targetBrand,
            selectedItem,
            labelGetters
        );
    }

    // è©³ç´°åˆ†æãƒ¢ãƒ¼ãƒ‰ï¼ˆæ—¢å­˜ï¼‰
    // ...
}, [/* ä¾å­˜é…åˆ— */]);
```

### ã‚¹ãƒ†ãƒƒãƒ—6: UIè­¦å‘Šã®å®Ÿè£…ï¼ˆ5åˆ†ï¼‰

#### ãƒ•ã‚¡ã‚¤ãƒ«: `components/DataSourceManager.tsx`

```typescript
// åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è­¦å‘Šã®åˆ¤å®šï¼ˆ80è¡Œç›®ã‚ãŸã‚Šï¼‰
const isBrandImageMode = analysisMode === 'historical_brand_image_segment_brand';
const isYourNewMode = analysisMode === 'historical_YOUR_NEW_MODE';  // â† è¿½åŠ 
const referenceSource = dataSources.find(ds => ds.isActive);

// è­¦å‘Šè¡¨ç¤ºï¼ˆ150è¡Œç›®ã‚ãŸã‚Šï¼‰
{(isBrandImageMode || isYourNewMode) && referenceSource && (
    <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 space-y-1">
        <div className="flex items-start gap-2">
            <svg className="w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0" /* ... */>
                <path /* ... */ />
            </svg>
            <div className="flex-1 text-sm">
                <p className="font-medium text-yellow-800">
                    åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: {referenceSource.name}
                </p>
                <p className="text-yellow-700 mt-1">
                    æœ€åˆã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®XXXé …ç›®ã‚’ã‚‚ã¨ã«ã€TOP{config.axes.items?.autoSelectCount || 30}ã‚’é¸å®šã—ã¾ã™ã€‚
                </p>
            </div>
        </div>
    </div>
)}
```

---

## ğŸ“ å®Ÿè£…æ™‚ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ

### 1. ãƒ¡ãƒ¢åŒ–ã®å¾¹åº• ğŸ”’

**å•é¡Œ**: ç„¡é™ãƒ«ãƒ¼ãƒ—ã®ç™ºç”Ÿ

```typescript
// âŒ NG: æ¯å›æ–°ã—ã„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç”Ÿæˆã•ã‚Œã‚‹
const config = globalMode === 'historical' ? CONFIG_A : CONFIG_B;
useEffect(() => {
    // ç„¡é™ãƒ«ãƒ¼ãƒ—ç™ºç”Ÿï¼
}, [config]);

// âœ… OK: useMemoã§ãƒ¡ãƒ¢åŒ–
const config = useMemo(() => {
    return globalMode === 'historical' ? CONFIG_A : CONFIG_B;
}, [globalMode]);
useEffect(() => {
    // globalModeãŒå¤‰ã‚ã£ãŸæ™‚ã®ã¿å®Ÿè¡Œã•ã‚Œã‚‹
}, [config]);
```

### 2. å‹å®‰å…¨æ€§ã®ç¢ºä¿ âœ…

**é‡è¦**: TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æ´»ç”¨ã—ã¦è¨­å®šãƒŸã‚¹ã‚’é˜²ã

```typescript
// âœ… å‹ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ = è¨­å®šãƒŸã‚¹ãŒé˜²ã’ã‚‹
itemSet: 'funnel',     // OK
itemSet: 'brandPower', // OK
itemSet: 'invalid',    // âŒ TypeScriptã‚¨ãƒ©ãƒ¼
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° ğŸ“‹

**æ¨å¥¨**: console.warnã§è©³ç´°ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›

```typescript
if (!segmentData) {
    console.warn(`[Historical XXX] ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ '${selectedSegment}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
    return null;
}

if (!brandData) {
    console.warn(`[Historical XXX] ãƒ–ãƒ©ãƒ³ãƒ‰ '${selectedBrand}' ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
    return null;
}
```

### 4. ãƒ‡ãƒ¼ã‚¿ã®å­˜åœ¨ç¢ºèª âš ï¸

**å¿…é ˆ**: ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯0ã‚’è¿”ã™

```typescript
// âœ… OK: nullish coalescing ã§0ã‚’è¿”ã™
dataPoint[source.name] = brandData[key] ?? 0;

// âŒ NG: undefinedãŒå…¥ã‚‹å¯èƒ½æ€§
dataPoint[source.name] = brandData[key];
```

### 5. ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã®è¨­å®š ğŸ“Š

**Mode 4ã§æ–°ãŸã«ç¢ºèªã•ã‚ŒãŸé‡è¦ãƒã‚¤ãƒ³ãƒˆ**:

```typescript
defaultChartType: 'radar'  // â† ã“ã®è¨­å®šã ã‘ã§ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆãŒé©ç”¨ã•ã‚Œã‚‹
```

**æ—¢å­˜å®Ÿè£…ã®æ´»ç”¨**:
- `ChartArea.tsx`ã¯æ—¢ã«ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã«å¯¾å¿œæ¸ˆã¿
- è¨­å®šã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§è‡ªå‹•çš„ã«å‹•ä½œã™ã‚‹
- ã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒ—ã®åˆ‡ã‚Šæ›¿ãˆã‚‚è‡ªå‹•çš„ã«å¯èƒ½

---

## ğŸ“Š Mode 5-14 å®Ÿè£…è¨ˆç”»

### å®Ÿè£…æ¸ˆã¿ vs æœªå®Ÿè£…

| ãƒ¢ãƒ¼ãƒ‰ | ãƒ¢ãƒ¼ãƒ‰å | ãƒ‘ã‚¿ãƒ¼ãƒ³ | äºˆæ¸¬æ™‚é–“ | çŠ¶æ…‹ |
|-------|---------|---------|---------|------|
| Mode 1 | ãƒ•ã‚¡ãƒãƒ«åˆ†æâ‘  | åŸºç›¤ | - | âœ… å®Œäº† |
| Mode 2 | ãƒ•ã‚¡ãƒãƒ«åˆ†æâ‘¡ | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 5åˆ† | âœ… å®Œäº† |
| Mode 3 | ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æ | ãƒ‘ã‚¿ãƒ¼ãƒ³2 | 35åˆ† | âœ… å®Œäº† |
| Mode 4 | ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘  | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 3åˆ† | âœ… å®Œäº† |
| Mode 5 | å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘  | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 3åˆ† | â¸ï¸ æœªå®Ÿè£… |
| Mode 6 | å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æâ‘¡ | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 3åˆ† | â¸ï¸ æœªå®Ÿè£… |
| Mode 7 | ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆMode 7ï¼‰ | ãƒ‘ã‚¿ãƒ¼ãƒ³2 | 30åˆ† | â¸ï¸ æœªå®Ÿè£… |
| Mode 8 | ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆMode 8ï¼‰ | ãƒ‘ã‚¿ãƒ¼ãƒ³2 | 30åˆ† | â¸ï¸ æœªå®Ÿè£… |
| Mode 9-14 | ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—åˆ†æç­‰ | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 3-5åˆ†/å€‹ | â¸ï¸ æœªå®Ÿè£… |

### ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥å®Ÿè£…è¨ˆç”»

#### ãƒ•ã‚§ãƒ¼ã‚º1: å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æï¼ˆç´„6åˆ†ï¼‰âœ…

**å¯¾è±¡ãƒ¢ãƒ¼ãƒ‰**: Mode 5-6

**å®Ÿè£…å†…å®¹**:
- `itemSet: 'futurePower'`
- `fixedItems: ['FP1', 'FP2', 'FP3', 'FP4', 'FP5', 'FP6']`
- `defaultChartType: 'radar'`

**æ‰€è¦æ™‚é–“**: 6åˆ†ï¼ˆ2ãƒ¢ãƒ¼ãƒ‰ Ã— 3åˆ†ï¼‰

#### ãƒ•ã‚§ãƒ¼ã‚º2: ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆç³»ï¼ˆç´„15åˆ†ï¼‰âœ…

**å¯¾è±¡ãƒ¢ãƒ¼ãƒ‰**: Mode 9-14ï¼ˆã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—åˆ†æç­‰ï¼‰

**å®Ÿè£…å†…å®¹**:
- å„ãƒ¢ãƒ¼ãƒ‰ã®`itemSet`ã¨`fixedItems`ã‚’è¨­å®š
- `defaultChartType: 'radar'`

**æ‰€è¦æ™‚é–“**: 15åˆ†ï¼ˆ5ãƒ¢ãƒ¼ãƒ‰ Ã— 3åˆ†ï¼‰

#### ãƒ•ã‚§ãƒ¼ã‚º3: ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†ææ®‹ã‚Šï¼ˆç´„60åˆ†ï¼‰âš ï¸

**å¯¾è±¡ãƒ¢ãƒ¼ãƒ‰**: Mode 7-8

**å®Ÿè£…å†…å®¹**:
- Mode 3ã‚’å‚è€ƒã«å®Ÿè£…
- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆâ†”ãƒ–ãƒ©ãƒ³ãƒ‰ã®å½¹å‰²ã‚’å…¥ã‚Œæ›¿ãˆ

**æ‰€è¦æ™‚é–“**: 60åˆ†ï¼ˆ2ãƒ¢ãƒ¼ãƒ‰ Ã— 30åˆ†ï¼‰

### åˆè¨ˆäºˆæƒ³æ™‚é–“: ç´„80åˆ†ï¼ˆ1æ™‚é–“20åˆ†ï¼‰

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œãªã„ ğŸ”

#### ç—‡çŠ¶
- ãƒãƒ£ãƒ¼ãƒˆã‚¨ãƒªã‚¢ãŒç©ºç™½
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¨ãƒ©ãƒ¼ãªã—

#### åŸå› ã¨è§£æ±ºç­–

**åŸå› 1**: `seriesItems`ãŒç©ºé…åˆ—

```typescript
// ChartArea.tsxï¼ˆç¢ºèªç®‡æ‰€: 120è¡Œç›®ã‚ãŸã‚Šï¼‰
const seriesItems = useMemo(() => {
    if (globalMode === 'historical') {
        // âœ… éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰æ™‚ã¯ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹åã‚’ä½¿ç”¨
        return dataSources.filter(ds => ds.isActive).map(ds => ds.name);
    }
    // è©³ç´°åˆ†æãƒ¢ãƒ¼ãƒ‰ã®ãƒ­ã‚¸ãƒƒã‚¯
}, [globalMode, dataSources]);

// ãƒ‡ãƒãƒƒã‚°
console.log('seriesItems:', seriesItems);  // ç©ºé…åˆ—ã§ãªã„ã“ã¨ã‚’ç¢ºèª
```

**åŸå› 2**: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒã™ã¹ã¦éã‚¢ã‚¯ãƒ†ã‚£ãƒ–

```typescript
// æœ€ä½1ã¤ã¯ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãŒå¿…è¦
const activeSources = dataSources.filter(ds => ds.isActive);
if (activeSources.length === 0) {
    console.warn('ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã›ã‚“');
    return null;
}
```

**åŸå› 3**: `chartData`ãŒnull

```typescript
// App.tsxï¼ˆãƒ‡ãƒãƒƒã‚°ï¼‰
console.log('chartData:', chartData);  // nullã§ãªã„ã“ã¨ã‚’ç¢ºèª
```

### å•é¡Œ2: ãƒªãƒ³ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼ âš ï¸

#### ç—‡çŠ¶
```
å‹ 'number | ArchetypeMetrics' ã‚’å‹ 'number' ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
```

#### è§£æ±ºç­–

```typescript
// âŒ NG: å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã®ã¿
const value = brandData[key as keyof AllMetrics];
return value;

// âœ… OK: å‹ã‚¬ãƒ¼ãƒ‰
const value = brandData[key as keyof AllMetrics];
return typeof value === 'number' ? value : undefined;

// âœ… OK: nullish coalescing
const value = brandData[key as keyof AllMetrics];
return (typeof value === 'number' ? value : undefined) ?? 0;
```

### å•é¡Œ3: åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è­¦å‘ŠãŒè¡¨ç¤ºã•ã‚Œãªã„ ğŸ“¢

#### åŸå› 
- `analysisMode` propsãŒ`DataSourceManager`ã«æ¸¡ã•ã‚Œã¦ã„ãªã„

#### è§£æ±ºç­–

```typescript
// Sidebar.tsxï¼ˆç¢ºèªç®‡æ‰€: 200è¡Œç›®ã‚ãŸã‚Šï¼‰
<DataSourceManager
    dataSources={dataSources}
    addDataSource={addDataSource}
    removeDataSource={removeDataSource}
    updateDataSourceName={updateDataSourceName}
    toggleDataSourceActive={toggleDataSourceActive}
    analysisMode={analysisMode}  // â† ã“ã®propsã‚’ç¢ºèª
/>
```

### å•é¡Œ4: ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„ ğŸ“Š

#### ç—‡çŠ¶
- Mode 4ã§ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œãªã„
- æ£’ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### è§£æ±ºç­–

```typescript
// constants/analysisConfigs.tsï¼ˆç¢ºèªç®‡æ‰€ï¼‰
'historical_YOUR_MODE': {
    // ...
    defaultChartType: 'radar'  // â† ã“ã®è¨­å®šã‚’ç¢ºèª
}

// ChartArea.tsxï¼ˆãƒ‡ãƒãƒƒã‚°ï¼‰
console.log('currentChartType:', chartType);  // 'radar'ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
```

---

## ğŸ“š å‚è€ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### è¦ä»¶å®šç¾©æ›¸
1. `docs/HISTORICAL_COMPARISON_REQUIREMENTS.md` - å…¨ä½“è¦ä»¶
2. `docs/HISTORICAL_MODE1_IMPLEMENTATION.md` - Mode 1æŠ€è¡“ä»•æ§˜
3. `docs/HISTORICAL_MODE2_REQUIREMENTS.md` - Mode 2è¦ä»¶
4. `docs/HISTORICAL_MODE3_REQUIREMENTS.md` - Mode 3è¦ä»¶
5. `docs/HISTORICAL_MODE4_REQUIREMENTS.md` - Mode 4è¦ä»¶

### å®Ÿè£…å ±å‘Šæ›¸
1. `docs/HISTORICAL_MODE1_IMPLEMENTATION_REPORT.md` - Mode 1å®Ÿè£…å®Œäº†
2. `docs/HISTORICAL_MODE2_IMPLEMENTATION_REPORT.md` - Mode 2å®Ÿè£…å®Œäº†
3. `docs/HISTORICAL_MODE3_IMPLEMENTATION_REPORT.md` - Mode 3å®Ÿè£…å®Œäº†
4. `docs/HISTORICAL_MODE4_IMPLEMENTATION_REPORT.md` - Mode 4å®Ÿè£…å®Œäº†

### è©³ç´°åˆ†æãƒ¢ãƒ¼ãƒ‰å‚è€ƒ
1. `docs/mode7_brand_image_segment_brands_requirements.md` - ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æ
2. `docs/mode9_brand_power_segment_brands_requirements.md` - ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ‘ãƒ¯ãƒ¼åˆ†æ
3. `docs/mode11_future_power_requirements.md` - å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æ
4. `docs/mode13_archetype_segment_brands_requirements.md` - ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—åˆ†æ

---

## âœ… å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ‘ã‚¿ãƒ¼ãƒ³1ï¼ˆå›ºå®šé …ç›®ãƒ¢ãƒ¼ãƒ‰ï¼‰- 3-5åˆ†

- [ ] **ã‚¹ãƒ†ãƒƒãƒ—1**: å‹å®šç¾©ã«è¿½åŠ ï¼ˆ`src/types/analysis.ts`ï¼‰ - 30ç§’
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—2**: ãƒ¢ãƒ¼ãƒ‰è¨­å®šè¿½åŠ ï¼ˆ`constants/analysisConfigs.ts`ï¼‰ - 2åˆ†
  - [ ] id, name, descriptionè¨­å®š
  - [ ] itemSetè¨­å®šï¼ˆä¾‹: 'brandPower'ï¼‰
  - [ ] fixedItemsè¨­å®šï¼ˆä¾‹: ['BP1', 'BP2', 'BP3', 'BP4']ï¼‰
  - [ ] allowMultiple: falseï¼ˆsegments/brandsï¼‰
  - [ ] series: 'dataSources'
  - [ ] defaultChartTypeè¨­å®šï¼ˆ'bar', 'line', 'radar'ï¼‰
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—3**: ãƒ¢ãƒ¼ãƒ‰é¸æŠé †åºã«è¿½åŠ ï¼ˆ`HISTORICAL_ANALYSIS_MODE_ORDER`ï¼‰ - 30ç§’
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—4**: ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯ - 30ç§’
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—5**: å‹•ä½œç¢ºèªï¼ˆé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ï¼‰
  - [ ] ãƒ¢ãƒ¼ãƒ‰é¸æŠå¯èƒ½
  - [ ] ã‚°ãƒ©ãƒ•è¡¨ç¤º
  - [ ] ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
  - [ ] ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ON/OFFåˆ‡ã‚Šæ›¿ãˆ
  - [ ] ã‚°ãƒ©ãƒ•ã‚¿ã‚¤ãƒ—åˆ‡ã‚Šæ›¿ãˆ

### ãƒ‘ã‚¿ãƒ¼ãƒ³2ï¼ˆå‹•çš„é …ç›®ãƒ¢ãƒ¼ãƒ‰ï¼‰- 30-35åˆ†

- [ ] **ã‚¹ãƒ†ãƒƒãƒ—1-3**: ãƒ‘ã‚¿ãƒ¼ãƒ³1ã¨åŒã˜ + autoSelectè¨­å®š - 3åˆ†
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—4**: å°‚ç”¨ãƒ‡ãƒ¼ã‚¿å¤‰æ›é–¢æ•°å®Ÿè£…ï¼ˆ`utils/dataTransforms.ts`ï¼‰ - 20åˆ†
  - [ ] é–¢æ•°å®šç¾©
  - [ ] ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚½ãƒ¼ã‚¹ãƒ•ã‚£ãƒ«ã‚¿
  - [ ] ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  - [ ] TOPné …ç›®é¸å®šãƒ­ã‚¸ãƒƒã‚¯
  - [ ] ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆç”Ÿæˆ
  - [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—5**: App.tsxã§åˆ†å²è¿½åŠ  - 5åˆ†
  - [ ] importæ–‡ã«é–¢æ•°è¿½åŠ 
  - [ ] isHistoricalMode()å†…ã«åˆ†å²è¿½åŠ 
  - [ ] ä¾å­˜é…åˆ—ã«å¿…è¦ãªå¤‰æ•°è¿½åŠ 
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—6**: UIè­¦å‘Šå®Ÿè£…ï¼ˆ`components/DataSourceManager.tsx`ï¼‰ - 5åˆ†
  - [ ] åˆ¤å®šæ¡ä»¶è¿½åŠ 
  - [ ] è­¦å‘Šè¡¨ç¤ºè¿½åŠ 
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—7**: ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯ - 2åˆ†
- [ ] **ã‚¹ãƒ†ãƒƒãƒ—8**: å‹•ä½œç¢ºèª
  - [ ] åŸºæº–ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è­¦å‘Šè¡¨ç¤º
  - [ ] TOPné …ç›®è¡¨ç¤º
  - [ ] ã‚°ãƒ©ãƒ•è¡¨ç¤º
  - [ ] ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º

---

## ğŸ¯ æˆåŠŸã®ç§˜è¨£

### 1. Mode 1ã®åŸºç›¤ã‚’ä¿¡é ¼ã™ã‚‹ ğŸ’ª

Mode 1ã§æ§‹ç¯‰ã—ãŸåŸºç›¤ã¯**å®Œç’§ã«æ©Ÿèƒ½**ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã‚’ãã®ã¾ã¾æ´»ç”¨ã§ãã¾ã™ï¼š

- âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰ç®¡ç†ï¼ˆ`useGlobalMode`ï¼‰
- âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆ`useMultiDataSource`ï¼‰
- âœ… UIåˆ¶ç´„ï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ã®SAï¼‰
- âœ… ã‚°ãƒ©ãƒ•è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ`ChartArea`ï¼‰
- âœ… ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤º
- âœ… ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå¯¾å¿œï¼ˆMode 4ã§ç¢ºèªï¼‰

### 2. ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹æ¥µã‚ã‚‹ ğŸ”

å®Ÿè£…å‰ã«**ã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹**ã‚’åˆ¤æ–­ã™ã‚‹ã“ã¨ã§ã€æ‰€è¦æ™‚é–“ã‚’æ­£ç¢ºã«äºˆæ¸¬ã§ãã¾ã™ï¼š

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | åˆ¤æ–­åŸºæº– | å®Ÿè£…æ™‚é–“ | æ–°è¦ã‚³ãƒ¼ãƒ‰ |
|---------|---------|---------|----------|
| **ãƒ‘ã‚¿ãƒ¼ãƒ³1** | Xè»¸é …ç›®ãŒå›ºå®š | 3-5åˆ† | ç´„30è¡Œ |
| **ãƒ‘ã‚¿ãƒ¼ãƒ³2** | Xè»¸é …ç›®ãŒå‹•çš„ï¼ˆTOP30ç­‰ï¼‰ | 30-35åˆ† | ç´„150è¡Œ |

### 3. å®Ÿè£…é †åºã‚’å®ˆã‚‹ ğŸ“

**æ¨å¥¨é †åº**:
1. ãƒ‘ã‚¿ãƒ¼ãƒ³1ã®ãƒ¢ãƒ¼ãƒ‰ã‚’å…ˆã«å®Ÿè£…ï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰
2. å‹•ä½œç¢ºèªã—ã¦è‡ªä¿¡ã‚’ã¤ã‘ã‚‹
3. ãƒ‘ã‚¿ãƒ¼ãƒ³2ã®ãƒ¢ãƒ¼ãƒ‰ã‚’å®Ÿè£…ï¼ˆMode 3ã‚’å‚è€ƒï¼‰

### 4. Mode 3/4ã‚’å‚è€ƒã«ã™ã‚‹ ğŸ“–

- **ãƒ‘ã‚¿ãƒ¼ãƒ³1** â†’ Mode 2, Mode 4ã‚’å‚è€ƒ
- **ãƒ‘ã‚¿ãƒ¼ãƒ³2** â†’ Mode 3ã‚’å‚è€ƒ

**Mode 4ã®æ–°ãŸãªçŸ¥è¦‹**:
- å®Ÿè£…é€Ÿåº¦ãŒã•ã‚‰ã«å‘ä¸Šï¼ˆ5åˆ†â†’3åˆ†ï¼‰
- ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚‚è¨­å®šã®ã¿ã§å‹•ä½œ
- è¨­è¨ˆã®å®Œæˆåº¦ãŒè¨¼æ˜ã•ã‚ŒãŸ

### 5. æ®µéšçš„ã«ãƒ†ã‚¹ãƒˆã™ã‚‹ âœ…

å„ã‚¹ãƒ†ãƒƒãƒ—ã§å‹•ä½œç¢ºèªã™ã‚‹ã“ã¨ã§ã€å•é¡Œã‚’æ—©æœŸç™ºè¦‹ã§ãã¾ã™ï¼š

1. å‹å®šç¾©è¿½åŠ  â†’ ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯
2. ãƒ¢ãƒ¼ãƒ‰è¨­å®šè¿½åŠ  â†’ ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯
3. é–¢æ•°å®Ÿè£…ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³2ã®ã¿ï¼‰ â†’ ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯
4. App.tsxä¿®æ­£ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³2ã®ã¿ï¼‰ â†’ ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯
5. UIè­¦å‘Šè¿½åŠ ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³2ã®ã¿ï¼‰ â†’ ãƒªãƒ³ã‚¿ãƒ¼ãƒã‚§ãƒƒã‚¯
6. æœ€çµ‚ç¢ºèª â†’ ãƒ–ãƒ©ã‚¦ã‚¶ã§å‹•ä½œç¢ºèª

---

## ğŸ“Š å®Ÿè£…å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿

### å®Ÿè£…æ™‚é–“å®Ÿç¸¾

| ãƒ¢ãƒ¼ãƒ‰ | ãƒ‘ã‚¿ãƒ¼ãƒ³ | äºˆå®šæ™‚é–“ | å®Ÿç¸¾æ™‚é–“ | é”æˆç‡ | ã‚³ãƒ¡ãƒ³ãƒˆ |
|-------|---------|---------|---------|--------|---------|
| Mode 1 | åŸºç›¤æ§‹ç¯‰ | - | 3æ—¥ | - | åŸºç›¤æ§‹ç¯‰ |
| Mode 2 | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 10åˆ† | **5åˆ†** | 50% âš¡ | äºˆæƒ³ã®åŠåˆ† |
| Mode 3 | ãƒ‘ã‚¿ãƒ¼ãƒ³2 | 40åˆ† | **35åˆ†** | 88% âœ¨ | ã»ã¼äºˆæƒ³é€šã‚Š |
| Mode 4 | ãƒ‘ã‚¿ãƒ¼ãƒ³1 | 5åˆ† | **3åˆ†** | 60% ğŸš€ | ã•ã‚‰ã«é«˜é€ŸåŒ–ï¼ |

**é‡è¦ãªç™ºè¦‹**:
- å®Ÿè£…é€Ÿåº¦ãŒå‘ä¸Šã—ã¦ã„ã‚‹ï¼ˆ5åˆ†â†’3åˆ†ï¼‰
- è¨­è¨ˆã®å®Œæˆåº¦ãŒè¨¼æ˜ã•ã‚ŒãŸ
- Mode 5ä»¥é™ã‚‚3åˆ†ã§å®Ÿè£…å¯èƒ½ã¨äºˆæ¸¬

### ã‚³ãƒ¼ãƒ‰å¤‰æ›´é‡

| ãƒ¢ãƒ¼ãƒ‰ | è¿½åŠ è¡Œæ•° | å‰Šé™¤è¡Œæ•° | å¤‰æ›´è¡Œæ•° | æ–°è¦ã‚³ãƒ¼ãƒ‰ |
|-------|---------|---------|---------|----------|
| Mode 1 | ç´„1000è¡Œ | - | ç´„1000è¡Œ | å¤§é‡ |
| Mode 2 | 29è¡Œ | 1è¡Œ | 30è¡Œ | 0è¡Œ |
| Mode 3 | 155è¡Œ | 15è¡Œ | 170è¡Œ | ç´„150è¡Œ |
| Mode 4 | 32è¡Œ | 1è¡Œ | 33è¡Œ | 0è¡Œ |

### ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿç‡

- **ãƒªãƒ³ã‚¿ãƒ¼ã‚¨ãƒ©ãƒ¼**: Mode 3ã§2ä»¶ï¼ˆå³åº§ã«ä¿®æ­£ï¼‰
- **å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼**: 0ä»¶
- **ãƒ­ã‚¸ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼**: 0ä»¶
- **è¨­å®šãƒŸã‚¹**: 0ä»¶ï¼ˆå‹ã‚·ã‚¹ãƒ†ãƒ ãŒé˜²æ­¢ï¼‰

---

## ğŸš€ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

### å³åº§ã«å®Ÿè£…å¯èƒ½ãªãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨é †ï¼‰

1. **Mode 5-6ï¼ˆç´„6åˆ†ï¼‰** âœ… - ãƒ‘ã‚¿ãƒ¼ãƒ³1ã€æœ€ã‚‚ç°¡å˜
   - å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æ
   - `itemSet: 'futurePower'`
   - `defaultChartType: 'radar'`

2. **Mode 9-14ï¼ˆç´„15åˆ†ï¼‰** âœ… - ãƒ‘ã‚¿ãƒ¼ãƒ³1ã€ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆç³»
   - ã‚¢ãƒ¼ã‚­ã‚¿ã‚¤ãƒ—åˆ†æç­‰
   - å„ãƒ¢ãƒ¼ãƒ‰ã®`itemSet`ã¨`fixedItems`ã‚’è¨­å®š
   - `defaultChartType: 'radar'`

3. **Mode 7-8ï¼ˆç´„60åˆ†ï¼‰** âš ï¸ - ãƒ‘ã‚¿ãƒ¼ãƒ³2ã€Mode 3ã‚’å‚è€ƒ
   - ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æ
   - ã‚»ã‚°ãƒ¡ãƒ³ãƒˆâ†”ãƒ–ãƒ©ãƒ³ãƒ‰ã®å½¹å‰²ã‚’å…¥ã‚Œæ›¿ãˆ

### æ¨å¥¨å®Ÿè£…é †åº

```
Phase 1: Mode 5 â†’ Mode 6
         (å°†æ¥æ€§ãƒ‘ãƒ¯ãƒ¼åˆ†æã€å›ºå®šé …ç›®)
         äºˆæ¸¬æ™‚é–“: 6åˆ†
         
Phase 2: Mode 9 â†’ Mode 10 â†’ Mode 11 â†’ Mode 12 â†’ Mode 13 â†’ Mode 14
         (ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆç³»ã€å›ºå®šé …ç›®)
         äºˆæ¸¬æ™‚é–“: 15-20åˆ†
         
Phase 3: Mode 7 â†’ Mode 8
         (ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸åˆ†æã€å‹•çš„é …ç›®)
         äºˆæ¸¬æ™‚é–“: 60åˆ†
         
åˆè¨ˆäºˆæ¸¬æ™‚é–“: ç´„80åˆ†
```

---

## ğŸ’¡ æœ€å¾Œã«

### å®Ÿè£…ã®å“²å­¦

1. **æœ€åˆã®å®Ÿè£…ã«æ™‚é–“ã‚’ã‹ã‘ã‚‹** â†’ Mode 1ã§3æ—¥ã‹ã‘ãŸçµæœã€Mode 2-4ã¯åˆè¨ˆ13åˆ†ã§å®Œäº†
2. **è¨­å®šé§†å‹•å‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ** â†’ ã‚³ãƒ¼ãƒ‰ã§ã¯ãªãè¨­å®šã§åˆ¶å¾¡
3. **è²¬å‹™ã®æ˜ç¢ºãªåˆ†é›¢** â†’ å„é–¢æ•°ãŒå˜ä¸€è²¬ä»»ã‚’æŒã¤
4. **å‹å®‰å…¨æ€§ã®å¾¹åº•** â†’ TypeScriptã®æ©æµã‚’æœ€å¤§é™æ´»ç”¨
5. **æ®µéšçš„ãªå®Ÿè£…ã¨æ¤œè¨¼** â†’ å„ã‚¹ãƒ†ãƒƒãƒ—ã§å‹•ä½œç¢ºèª

### Mode 1-4ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸé‡è¦ãªçŸ¥è¦‹

#### Mode 1ï¼ˆ3æ—¥ï¼‰
- **å­¦ç¿’**: åŸºç›¤æ§‹ç¯‰ã®é‡è¦æ€§
- **æˆæœ**: å®Œç’§ãªè¨­è¨ˆã¨å®Ÿè£…

#### Mode 2ï¼ˆ5åˆ†ï¼‰
- **å­¦ç¿’**: è¨­å®šé§†å‹•å‹ã®æœ‰åŠ¹æ€§
- **æˆæœ**: æ–°è¦ã‚³ãƒ¼ãƒ‰0è¡Œã§å®Ÿè£…å®Œäº†

#### Mode 3ï¼ˆ35åˆ†ï¼‰
- **å­¦ç¿’**: å‹•çš„é …ç›®ã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³
- **æˆæœ**: å†åˆ©ç”¨å¯èƒ½ãªé–¢æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³

#### Mode 4ï¼ˆ3åˆ†ï¼‰
- **å­¦ç¿’**: å®Ÿè£…é€Ÿåº¦ã®å‘ä¸Š
- **æˆæœ**: ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆå¯¾å¿œã®ç¢ºèª
- **ç™ºè¦‹**: è¨­è¨ˆã®å®Œæˆåº¦ãŒã•ã‚‰ã«è¨¼æ˜ã•ã‚ŒãŸ

### å®Ÿè£…è€…ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

Mode 1-4ã®å®Ÿè£…ã«ã‚ˆã‚Šã€éå»æ¯”è¼ƒãƒ¢ãƒ¼ãƒ‰ã®åŸºç›¤ã¯**å®Œç’§ã«å®Œæˆ**ã—ã¾ã—ãŸã€‚

æ®‹ã‚Šã®Mode 5-14ã¯ã€ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«å¾“ãˆã°**ç´„80åˆ†**ã§å®Ÿè£…å¯èƒ½ã§ã™ã€‚

**è¿·ã£ãŸã‚‰**:
- âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³1 â†’ Mode 2ã¾ãŸã¯Mode 4ã‚’å‚è€ƒ
- âœ… ãƒ‘ã‚¿ãƒ¼ãƒ³2 â†’ Mode 3ã‚’å‚è€ƒ
- âœ… ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ â†’ Mode 4ã‚’å‚è€ƒ

**å›°ã£ãŸã‚‰**:
- ğŸ“– ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§
- ğŸ“– Mode 1-4ã®å®Ÿè£…å ±å‘Šæ›¸ã‚’ç¢ºèª
- ğŸ“– æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚€ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆãŒå……å®Ÿï¼‰

**æˆåŠŸã‚’ç¥ˆã‚Šã¾ã™ï¼** ğŸš€âœ¨

---

**Document Version**: 2.0  
**Created**: 2025-11-30  
**Last Updated**: 2025-11-30ï¼ˆMode 4å®Ÿè£…å®Œäº†ã‚’åæ˜ ï¼‰  
**Status**: âœ… Complete  
**Next Update**: Mode 5-14 å®Ÿè£…å®Œäº†å¾Œ

---

## ğŸ“Œ ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### ãƒ‘ã‚¿ãƒ¼ãƒ³1å®Ÿè£…ï¼ˆ3åˆ†ï¼‰

```bash
# 1. å‹å®šç¾©è¿½åŠ 
# src/types/analysis.ts ã« 1è¡Œè¿½åŠ 

# 2. ãƒ¢ãƒ¼ãƒ‰è¨­å®šè¿½åŠ 
# constants/analysisConfigs.ts ã«ç´„30è¡Œè¿½åŠ 

# 3. ãƒ¢ãƒ¼ãƒ‰é¸æŠé †åºè¿½åŠ 
# HISTORICAL_ANALYSIS_MODE_ORDER ã« 1è¡Œè¿½åŠ 

# 4. å®Œäº†ï¼
```

### ãƒ‘ã‚¿ãƒ¼ãƒ³2å®Ÿè£…ï¼ˆ35åˆ†ï¼‰

```bash
# 1-3. ãƒ‘ã‚¿ãƒ¼ãƒ³1ã¨åŒã˜ï¼ˆ3åˆ†ï¼‰

# 4. å°‚ç”¨é–¢æ•°å®Ÿè£…ï¼ˆ20åˆ†ï¼‰
# utils/dataTransforms.ts ã«é–¢æ•°è¿½åŠ 

# 5. App.tsxåˆ†å²è¿½åŠ ï¼ˆ5åˆ†ï¼‰

# 6. UIè­¦å‘Šå®Ÿè£…ï¼ˆ5åˆ†ï¼‰
# components/DataSourceManager.tsx ã«è­¦å‘Šè¿½åŠ 

# 7. å®Œäº†ï¼
```

### ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰

```typescript
// chartDataç¢ºèª
console.log('chartData:', chartData);

// seriesItemsç¢ºèª
console.log('seriesItems:', seriesItems);

// ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚½ãƒ¼ã‚¹ç¢ºèª
console.log('activeSources:', dataSources.filter(ds => ds.isActive));

// ãƒ¢ãƒ¼ãƒ‰è¨­å®šç¢ºèª
console.log('config:', currentModeConfigs[analysisMode]);
```

