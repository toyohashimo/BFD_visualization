# モード12 - ブランドパワー分析②（将来性パワー×セグメント）要件定義書

## 最終更新
2025-11-29

---

## 1. 概要

### 1.1 モード名
**モード12**: ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）

### 1.2 モードID
`future_power_brand_segments`

### 1.3 目的
特定のブランドにおいて、複数のセグメント間で**将来性パワー指標（FP1-FP6）**を比較し、セグメント別のブランド将来性ポテンシャルを評価する。

### 1.4 参照モード
**モード10**（`brand_power_brand_segments`）: ブランドパワー分析①（ブランド: X=現在パワー×セグメント）

### 1.5 モード10との差分
| 項目 | モード10（現在パワー） | モード12（将来性パワー） |
|------|---------------------|------------------------|
| **モードID** | `brand_power_brand_segments` | `future_power_brand_segments` |
| **分析指標数** | 4項目（BP1～BP4） | 6項目（FP1～FP6） |
| **Excel取得元** | AF～AI列（4列） | AJ～AO列（6列） |
| **指標の内容** | 詳細認知、知覚品質、ロイヤリティ、話題性 | 目的意識、社会との向き合い、顧客理解力、双方向コミュニケーション、技術開発力、自己実現サポート |
| **評価対象** | 現在のブランド力 | 将来の成長ポテンシャル |
| **分析項目表記** | 「現在パワー」 | 「将来性パワー」 |
| **X軸** | BP1～BP4（現在パワー） | FP1～FP6（将来性パワー） |
| **データ系列** | 複数セグメント | 複数セグメント |
| **フィルタ** | 単一ブランド | 単一ブランド |
| **デフォルトチャート** | レーダーチャート | レーダーチャート |

### 1.6 モード11との関係
| 項目 | モード11（セグメント固定） | モード12（ブランド固定） |
|------|-------------------------|------------------------|
| **モードID** | `future_power_segment_brands` | `future_power_brand_segments` |
| **固定軸** | 単一セグメント | 単一ブランド |
| **比較軸** | 複数ブランド | 複数セグメント |
| **分析指標** | FP1～FP6（共通） | FP1～FP6（共通） |
| **分析視点** | 「セグメント内でブランドを比較」 | 「ブランド内でセグメントを比較」 |

---

## 2. 将来性パワー指標（FP1-FP6）

### 2.1 指標一覧

| 指標コード | 指標名 | Excel列 | 列インデックス | 説明 |
|:---|:---|:---|:---|:---|
| FP1 | 目的意識 | AJ | 35 | ブランドが明確なビジョンや目的を持っているか |
| FP2 | 社会との向き合い | AK | 36 | 社会課題への取り組み姿勢 |
| FP3 | 顧客理解力 | AL | 37 | 顧客ニーズの理解度 |
| FP4 | 双方向コミュニケーション | AM | 38 | 顧客との対話姿勢 |
| FP5 | 技術開発力 | AN | 39 | イノベーション創出力 |
| FP6 | 自己実現サポート | AO | 40 | 顧客の成長支援度 |

### 2.2 各指標の詳細

#### FP1: 目的意識
- **定義**: ブランドが明確なビジョンや目的を持っているか
- **評価内容**: ブランドの存在意義、社会的使命の明確さ
- **マーケティング的意義**: ブランドアイデンティティの核心を測定

#### FP2: 社会との向き合い
- **定義**: 社会課題への取り組み姿勢
- **評価内容**: サステナビリティ、社会貢献活動への積極性
- **マーケティング的意義**: 社会的価値への共感を測定

#### FP3: 顧客理解力
- **定義**: 顧客ニーズの理解度
- **評価内容**: 顧客インサイトの把握力、市場理解の深さ
- **マーケティング的意義**: 顧客中心主義の実践度を測定

#### FP4: 双方向コミュニケーション
- **定義**: 顧客との対話姿勢
- **評価内容**: エンゲージメント構築力、対話の質
- **マーケティング的意義**: 関係構築力を測定

#### FP5: 技術開発力
- **定義**: イノベーション創出力
- **評価内容**: 技術革新への投資、新製品開発力
- **マーケティング的意義**: 将来への適応力を測定

#### FP6: 自己実現サポート
- **定義**: 顧客の成長支援度
- **評価内容**: 顧客エンパワーメント、価値創造支援
- **マーケティング的意義**: 顧客との共創姿勢を測定

---

## 3. 実装仕様

### 3.1 モード設定（constants/analysisConfigs.ts）

```typescript
'future_power_brand_segments': {
    id: 'future_power_brand_segments',
    name: 'ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）',
    description: '単一ブランドにおける複数セグメントの将来性パワー指標を比較',
    axes: {
        items: {
            role: 'X_AXIS',
            label: '分析項目',
            allowMultiple: false,
            itemSet: 'futurePower',
            fixedItems: ['FP1', 'FP2', 'FP3', 'FP4', 'FP5', 'FP6']
        },
        segments: {
            role: 'SERIES',
            label: 'セグメント比較',
            allowMultiple: true
        },
        brands: {
            role: 'FILTER',
            label: 'ブランド選択',
            allowMultiple: false
        }
    },
    dataTransform: {
        xAxis: 'items',
        series: 'segments',
        filter: 'brands'
    },
    defaultChartType: 'radar'
}
```

### 3.2 型定義（types.ts）

**既存の型定義を流用**:
- `FuturePowerMetrics` インターフェース（FP1～FP6）
- `FUTURE_POWER_LABELS` 定数
- `FUTURE_POWER_KEYS` 配列
- `ItemSet` 型の `'futurePower'`
- `getItemKeysForSet()` および `getItemLabelsForSet()` ヘルパー関数

**追加が必要な型**:
```typescript
export type AnalysisMode =
  | 'funnel_segment_brands'
  | 'funnel_brand_segments'
  | 'funnel_item_segments_brands'
  | 'timeline_brand_segments'
  | 'timeline_segment_brands'
  | 'timeline_item_segments_brands'
  | 'brand_image_segment_brands'
  | 'brand_image_brand_segments'
  | 'brand_power_segment_brands'
  | 'brand_power_brand_segments'
  | 'future_power_segment_brands'
  | 'future_power_brand_segments';  // ← 追加
```

### 3.3 データパース処理（App.tsx）

**既存の実装を流用**:
モード11で実装済みの以下の処理を活用：

```typescript
// 既にモード11で実装済み
const futurePowerColMap: Partial<Record<keyof FuturePowerMetrics, number>> = {};
const futurePowerLabels: Record<keyof FuturePowerMetrics, string> = {
  FP1: '目的意識',
  FP2: '社会との向き合い',
  FP3: '顧客理解力',
  FP4: '双方向コミュニケーション',
  FP5: '技術開発力',
  FP6: '自己実現サポート'
};

// ヘッダー解析ループ内（既存）
(Object.keys(futurePowerLabels) as (keyof FuturePowerMetrics)[]).forEach(key => {
  const label = futurePowerLabels[key];
  const idx = headers.findIndex(h => {
    const headerStr = h.trim().replace(/\r?\n/g, '');
    return headerStr === label;
  });
  if (idx !== -1) {
    futurePowerColMap[key] = idx;
  }
});

// データ行処理（既存）
(Object.keys(futurePowerLabels) as (keyof FuturePowerMetrics)[]).forEach(key => {
  const colIdx = futurePowerColMap[key];
  if (colIdx !== undefined) {
    let val = row[colIdx];
    if (val === '-' || val === undefined || val === null) val = 0;
    metrics[key] = typeof val === 'number' ? val : parseFloat(val) || 0;
  }
});
```

### 3.4 状態管理の更新（App.tsx）

```typescript
// analysisMode の初期値チェック
const validModes = [
  'funnel_segment_brands',
  'funnel_brand_segments',
  'funnel_item_segments_brands',
  'timeline_brand_segments',
  'timeline_segment_brands',
  'timeline_item_segments_brands',
  'brand_image_segment_brands',
  'brand_image_brand_segments',
  'brand_power_segment_brands',
  'brand_power_brand_segments',
  'future_power_segment_brands',
  'future_power_brand_segments'  // ← 追加
];
```

---

## 4. UI/UX仕様

### 4.1 UI要素の配置

#### モード選択エリア
- **モード選択ドロップダウン**: 「ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）」

#### 軸選択エリア
1. **ブランド選択**（フィルタ）
   - ラベル: 「ブランド選択」
   - 単一選択（ドロップダウン）
   - 必須選択

2. **セグメント選択**（データ系列）
   - ラベル: 「セグメント比較」
   - 複数選択可能（チェックボックス）
   - ドラッグ&ドロップで並び替え可能
   - 最低1つ選択必須

3. **分析項目**（X軸）
   - FP1～FP6（固定）
   - ユーザー選択不可（自動設定）

#### グラフエリア
- **デフォルトチャートタイプ**: レーダーチャート
- **切り替え可能なチャート**: 縦棒グラフ、横棒グラフ、折れ線グラフ
- **データラベル**: 表示/非表示切り替え可能
- **凡例**: セグメント名を表示

#### データテーブル
- **行ラベル**: 将来性パワー指標名（日本語）
  - 目的意識、社会との向き合い、顧客理解力、双方向コミュニケーション、技術開発力、自己実現サポート
- **列ラベル**: セグメント名
- **データ**: 各セルに数値表示

### 4.2 ユーザーインタラクション

#### 選択操作
1. モードを選択 → 「ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）」
2. ブランドを1つ選択
3. セグメントを複数選択
4. グラフが自動更新される

#### 表示操作
- チャートタイプ切り替えボタン
- データラベル表示/非表示トグル
- CSV出力ボタン
- PNG画像コピーボタン

#### 並び替え操作
- セグメントリストのドラッグ&ドロップで凡例とグラフの表示順を変更

---

## 5. ビジネス価値

### 5.1 分析の目的
1. **セグメント別将来性評価**: 特定ブランドが各セグメントでどの程度将来性を持つか評価
2. **セグメント戦略の最適化**: どのセグメントで将来性強化が必要か特定
3. **セグメント間のギャップ把握**: 将来性の強いセグメントと弱いセグメントを可視化

### 5.2 想定ユースケース

#### ユースケース1: セグメント別将来性診断
**シナリオ**: 自社ブランドAの将来性を若年層・中年層・シニア層で比較
- **操作**: モード12選択 → ブランドA選択 → 3セグメント選択
- **発見**: 若年層では「技術開発力」が高評価だが、シニア層では「顧客理解力」が低い
- **アクション**: シニア層向けのコミュニケーション戦略を見直す

#### ユースケース2: 将来性の偏りを発見
**シナリオ**: ブランドBが全セグメントで均等に将来性を持つか確認
- **操作**: モード12選択 → ブランドB選択 → 全セグメント選択
- **発見**: レーダーチャートで一部セグメントのみ形状が歪んでいる
- **アクション**: 弱いセグメント向けの将来性施策を強化

#### ユースケース3: モード11との併用分析
**シナリオ**: セグメント内ブランド比較（モード11）とブランド内セグメント比較（モード12）を併用
- **操作**:
  1. モード11で「全体セグメント」における3ブランドの将来性を比較
  2. モード12で「ブランドA」における3セグメントの将来性を比較
- **発見**: ブランドAは全体で強いが、特定セグメントでは弱い
- **アクション**: セグメント特化型の将来性施策を立案

### 5.3 モード10（現在パワー）との併用
- **現在 vs 将来のギャップ分析**:
  - モード10で現在パワー（BP1～BP4）をセグメント別に確認
  - モード12で将来性パワー（FP1～FP6）をセグメント別に確認
  - 「現在は強いが将来性に課題があるセグメント」を特定

---

## 6. 実装ステップ

### Phase 1: 型定義の拡張（types.ts）
- [x] **既にモード11で完了**: `FuturePowerMetrics` インターフェース
- [x] **既にモード11で完了**: `FUTURE_POWER_LABELS` 定数
- [x] **既にモード11で完了**: `FUTURE_POWER_KEYS` 定数
- [ ] `AnalysisMode` 型に `'future_power_brand_segments'` を追加

### Phase 2: モード設定の追加（constants/analysisConfigs.ts）
- [ ] `future_power_brand_segments` モード設定を追加
  - X軸: FP1～FP6（固定6項目）
  - データ系列: 複数セグメント
  - フィルタ: 単一ブランド
  - デフォルトチャート: レーダーチャート
- [ ] `ANALYSIS_MODE_ORDER` 配列に `'future_power_brand_segments'` を追加

### Phase 3: データパース処理の確認（App.tsx）
- [x] **既にモード11で完了**: `futurePowerColMap` の定義
- [x] **既にモード11で完了**: `futurePowerLabels` の定義
- [x] **既にモード11で完了**: ヘッダー解析ループに将来性パワー指標の検出ロジック
- [x] **既にモード11で完了**: データ行処理で将来性パワーメトリクスの読み込み
- **確認のみでOK**: パース処理はモード11と共通

### Phase 4: 状態管理の更新（App.tsx）
- [ ] `analysisMode` の初期値チェック（validModes）に `'future_power_brand_segments'` を追加
- [ ] LocalStorage の読み込み処理に新モードを追加

### Phase 5: テストとドキュメント
- [ ] 動作確認
  - データ読み込み
  - セグメント選択（複数選択）
  - ブランド選択（単一選択）
  - レーダーチャートのデフォルト表示
  - グラフタイプ切り替え
  - データラベル表示/非表示
  - CSV出力
  - PNG画像コピー
  - ドラッグ&ドロップでセグメント並び替え
- [ ] ドキュメント更新
  - README.md（12モード対応）
  - CHANGELOG.md（v2.5.0追加）
  - README_DOCS.md（索引更新）

---

## 7. 実装上の注意点

### 7.1 モード10との完全な対称性
モード10（現在パワー×セグメント）とモード12（将来性パワー×セグメント）は、指標が異なるだけで構造は完全に同じ：

| 要素 | モード10 | モード12 |
|------|---------|---------|
| フィルタ軸 | 単一ブランド | 単一ブランド |
| データ系列軸 | 複数セグメント | 複数セグメント |
| X軸 | BP1～BP4（現在パワー） | FP1～FP6（将来性パワー） |

### 7.2 モード11で実装済みの機能を活用
- **データパース処理**: モード11で実装済みのため追加不要
- **型定義**: モード11で実装済みのため追加不要
- **ヘルパー関数**: モード11で実装済みのため追加不要

### 7.3 実装の効率化
モード10の実装をコピーし、以下の箇所のみ変更すればOK：
1. モードID: `brand_power_brand_segments` → `future_power_brand_segments`
2. モード名: 「現在パワー」 → 「将来性パワー」
3. itemSet: `'brandPower'` → `'futurePower'`
4. fixedItems: `['BP1', 'BP2', 'BP3', 'BP4']` → `['FP1', 'FP2', 'FP3', 'FP4', 'FP5', 'FP6']`

---

## 8. 期待される成果物

### 8.1 コードファイル
1. **types.ts**
   - `AnalysisMode` 型に `'future_power_brand_segments'` 追加

2. **constants/analysisConfigs.ts**
   - `future_power_brand_segments` モード設定追加
   - `ANALYSIS_MODE_ORDER` に追加

3. **App.tsx**
   - `validModes` に `'future_power_brand_segments'` 追加
   - **データパース処理は既存流用（変更不要）**

### 8.2 ドキュメントファイル
1. **docs/mode12_future_power_brand_requirements.md** - 本ファイル（要件定義書）
2. **docs/mode12_implementation_summary.md** - 実装完了サマリー（実装後に作成）
3. **README.md** - 12モード対応に更新
4. **docs/CHANGELOG.md** - v2.5.0追加
5. **docs/README_DOCS.md** - 索引更新

---

## 9. 動作確認チェックリスト

実装後、以下の項目を確認：

- [ ] アプリケーションが正常に起動する
- [ ] モード選択ドロップダウンに「ブランドパワー分析②（ブランド: X=将来性パワー×セグメント）」が表示される
- [ ] Excelファイル読み込み時にFP1～FP6のデータが正しく取得される（モード11と共通）
- [ ] ブランド選択（単一）が動作する
- [ ] セグメント選択（複数）が動作する
- [ ] レーダーチャートがデフォルトで表示される
- [ ] レーダーチャートの軸ラベルが正式な項目名で表示される（目的意識、社会との向き合い、など）
- [ ] グラフタイプ切り替えが動作する（縦棒、横棒、折れ線）
- [ ] データラベル表示/非表示が動作する
- [ ] CSV出力が動作する
- [ ] PNG画像コピーが動作する
- [ ] ドラッグ&ドロップでセグメントの並び替えが動作する
- [ ] LocalStorageに設定が保存される
- [ ] ブラウザリロード後も設定が復元される

---

## 10. まとめ

### 実装の要点
1. **モード10のコピー&修正**: モード10の設定をコピーし、`brandPower` → `futurePower` に変更
2. **データパース処理は流用**: モード11で既に実装済みのため追加実装不要
3. **型定義は流用**: モード11で既に実装済みのため追加実装不要
4. **効率的な実装**: 最小限の変更で最大の効果

### モード12の位置づけ
- **モード9-12の体系**:
  - モード9: セグメント固定 × 現在パワー × 複数ブランド
  - モード10: ブランド固定 × 現在パワー × 複数セグメント ← 参照元
  - モード11: セグメント固定 × 将来性パワー × 複数ブランド
  - モード12: ブランド固定 × 将来性パワー × 複数セグメント ← 今回実装

### ビジネス価値
- **セグメント別の将来性評価**: 特定ブランドがどのセグメントで将来性を持つか明確化
- **モード10との補完**: 現在パワーと将来性パワーの両方でセグメント戦略を評価
- **モード11との補完**: ブランド比較とセグメント比較の両方の視点を提供

---

**文書ステータス**: 要件定義完了  
**作成日**: 2025-11-29  
**バージョン**: 1.0  
**次のステップ**: Phase 1～5の実装開始

