# モード2 - ファネル分析①（ブランド×複数セグメント）要件定義書

## 最終更新
2025-11-29

---

## 1. 概要

### 1.1 モード名
**モード2**: ファネル分析①（ブランド: X=ファネル①×セグメント）

### 1.2 モードID
`funnel_brand_segments`

### 1.3 目的
特定のブランドにおいて、複数のセグメント間で**ファネル指標（FT-GL）**を比較し、セグメント別の顧客行動段階の違いを評価する。

### 1.4 参照モード
**モード1**（`funnel_segment_brands`）: ファネル分析①（セグメント固定×複数ブランド）

### 1.5 モード1との差分
| 項目 | モード1（セグメント固定） | モード2（ブランド固定） |
|------|-------------------------|------------------------|
| **モードID** | `funnel_segment_brands` | `funnel_brand_segments` |
| **固定軸** | 単一セグメント | 単一ブランド |
| **比較軸** | 複数ブランド | 複数セグメント |
| **分析視点** | 「セグメント内でブランドを比較」 | 「ブランド内でセグメントを比較」 |
| **主な用途** | 競合比較 | セグメント別分析 |

---

## 2. ファネル指標（FT-GL）

### 2.1 指標一覧

| 指標コード | 指標名 | Excel列 | 列インデックス | 説明 |
|:---|:---|:---|:---|:---|
| FT | 認知あり(TOP2) | M | 12 | ブランドを認知している |
| FW | 興味あり(TOP2) | P | 15 | ブランドに興味がある |
| FZ | 好意あり(TOP2) | S | 18 | ブランドに好意を持っている |
| GC | 購入・利用意向あり(TOP2) | V | 21 | 購入・利用したい |
| GJ | 購入・利用経験あり(TOP5) | AD | 29 | 購入・利用したことがある |
| GL | リピート意向あり(TOP2) | AG | 32 | また購入・利用したい |

### 2.2 各指標の詳細

#### FT: 認知あり(TOP2)
- **定義**: ブランドを認知している度合い
- **評価内容**: ブランドの知名度
- **マーケティング的意義**: セグメント別の認知浸透度を測定

#### FW: 興味あり(TOP2)
- **定義**: ブランドに興味を持っている度合い
- **評価内容**: 認知から興味への転換
- **マーケティング的意義**: セグメント別の興味喚起効果を測定

#### FZ: 好意あり(TOP2)
- **定義**: ブランドに好意を持っている度合い
- **評価内容**: ブランドへの好感度
- **マーケティング的意義**: セグメント別のブランドイメージを測定

#### GC: 購入・利用意向あり(TOP2)
- **定義**: 購入・利用したい度合い
- **評価内容**: 購入への意欲
- **マーケティング的意義**: セグメント別のコンバージョン可能性を測定

#### GJ: 購入・利用経験あり(TOP5)
- **定義**: 実際に購入・利用したことがある度合い
- **評価内容**: 実際の購入経験
- **マーケティング的意義**: セグメント別の市場浸透度を測定

#### GL: リピート意向あり(TOP2)
- **定義**: また購入・利用したい度合い
- **評価内容**: リピート意欲
- **マーケティング的意義**: セグメント別のロイヤリティを測定

---

## 3. 分析モード詳細

### 3.1 分析軸の構成
- **X軸**: ファネル指標（固定6項目：FT～GL）
- **データ系列**: 選択した複数のセグメント
- **フィルタ**: ブランド（単一選択）

### 3.2 UI要素
- **分析項目セクション**: 【固定】バッジ表示、UI非表示（6指標は固定のため）
- **セグメントセクション**: 【MA】バッジ表示、複数選択リスト + ドラッグ＆ドロップ
- **ブランドセクション**: 【SA】バッジ表示、ドロップダウン選択

### 3.3 デフォルトチャートタイプ
**集合縦棒グラフ**

**理由**:
- 6指標の比較が視覚的に明確
- 複数セグメントの比較が容易
- セグメント間の違いを直感的に把握できる

---

## 4. データ要件

### 4.1 Excelファイルのフォーマット

#### 必要な列
| 列 | 列番号（0-based） | Excel列 | ヘッダー名 | 内部キー | 説明 |
|----|-----------------|---------|-----------|---------|------|
| ブランド名 | 3 | D | (任意) | - | ブランド識別子 |
| 認知あり | 12 | M | 認知あり(TOP2) | FT | ファネル指標1 |
| 興味あり | 15 | P | 興味あり(TOP2) | FW | ファネル指標2 |
| 好意あり | 18 | S | 好意あり(TOP2) | FZ | ファネル指標3 |
| 購入意向あり | 21 | V | 購入・利用意向あり(TOP2) | GC | ファネル指標4 |
| 購入経験あり | 29 | AD | 購入・利用経験あり(TOP5) | GJ | ファネル指標5 |
| リピート意向あり | 32 | AG | リピート意向あり(TOP2) | GL | ファネル指標6 |

#### データ形式
- **ヘッダー行**: 3行目
- **データ開始**: 4行目以降
- **データ型**: 数値（パーセンテージ）
- **欠損値処理**: 「-」または空白は自動的に0として処理

### 4.2 Excel列インデックスの対応表
```
A列 = 0
B列 = 1
C列 = 2
D列 = 3  ← ブランド名
...
M列 = 12 (FT: 認知あり) ★
P列 = 15 (FW: 興味あり) ★
S列 = 18 (FZ: 好意あり) ★
V列 = 21 (GC: 購入意向あり) ★
AD列 = 29 (GJ: 購入経験あり) ★
AG列 = 32 (GL: リピート意向あり) ★
```

---

## 5. 実装仕様

### 5.1 モード設定（constants/analysisConfigs.ts）

```typescript
'funnel_brand_segments': {
  id: 'funnel_brand_segments',
  name: 'ファネル分析①（ブランド: X=ファネル①×セグメント）',
  description: '単一ブランドにおける複数セグメントのファネル指標を比較',
  axes: {
    items: {
      role: 'X_AXIS',
      label: '分析項目',
      allowMultiple: false,
      itemSet: 'funnel',
      fixedItems: ['FT', 'FW', 'FZ', 'GC', 'GJ', 'GL']
    },
    segments: {
      role: 'SERIES',
      label: 'セグメント比較',
      allowMultiple: true
    },
    brands: {
      role: 'FILTER',
      label: 'ブランド選択',
      allowMultiple: false
    }
  },
  dataTransform: {
    xAxis: 'items',
    series: 'segments',
    filter: 'brands'
  },
  defaultChartType: 'bar'
}
```

### 5.2 型定義（types.ts）

**既存の型定義を流用**:
- `FunnelMetrics` インターフェース（FT～GL）
- `METRIC_LABELS` 定数
- `METRIC_KEYS` 配列
- `ItemSet` 型の `'funnel'`

### 5.3 データパース処理（App.tsx）

**既存の実装を流用**:
モード1で実装済みの以下の処理を活用：
- `funnelColMap` の定義
- `funnelLabels` の定義
- ヘッダー解析ループにファネル指標の検出ロジック
- データ行処理でファネルメトリクスの読み込み

---

## 6. ビジネス価値

### 6.1 分析の目的
1. **セグメント別パフォーマンス評価**: 特定ブランドが各セグメントでどの程度浸透しているか評価
2. **セグメント戦略の最適化**: どのセグメントで強化が必要か特定
3. **セグメント間のギャップ把握**: 強いセグメントと弱いセグメントを可視化

### 6.2 想定ユースケース

#### ユースケース1: セグメント別認知度分析
**シナリオ**: 自社ブランドAの認知度を若年層・中年層・シニア層で比較

- **操作**: モード2選択 → ブランドA選択 → 3セグメント選択
- **発見**: 若年層では認知度が高いが、シニア層では低い
- **アクション**: シニア層向けの認知拡大施策を立案

#### ユースケース2: セグメント別ファネル分析
**シナリオ**: ブランドBが各セグメントでファネルのどこで脱落が大きいか確認

- **操作**: モード2選択 → ブランドB選択 → 全セグメント選択
- **発見**: 男性セグメントでは「認知→興味」の転換率が低い
- **アクション**: 男性向けの興味喚起施策を強化

#### ユースケース3: モード1との併用分析
**シナリオ**: ブランド間比較（モード1）とセグメント間比較（モード2）を併用

- **操作**:
  1. モード1で「全体セグメント」における3ブランドの比較
  2. モード2で「ブランドA」における3セグメントの比較
- **発見**: ブランドAは全体では強いが、特定セグメントでは弱い
- **アクション**: セグメント特化型の施策を立案

---

## 7. 使用例

### シナリオ1: 性年代別のファネル分析

**目的**: 自社ブランドが各性年代でどのように評価されているか把握

**手順**:
1. モード2「ファネル分析①（ブランド×複数セグメント）」を選択
2. ブランド「自社ブランド」を選択
3. セグメント「男性20代」「男性30代」「女性20代」「女性30代」を選択
4. 集合縦棒グラフで比較

**分析ポイント**:
- どの性年代で認知度が高いか？
- どの性年代で購入経験が多いか？
- セグメント間でファネルの形状にどのような違いがあるか？

### シナリオ2: 地域別のブランド浸透度分析

**目的**: 自社ブランドの地域別の浸透度を把握

**手順**:
1. モード2を選択
2. ブランド「自社ブランド」を選択
3. セグメント「関東」「関西」「中部」「九州」を選択
4. 折れ線グラフに切り替えてトレンドを確認

**分析ポイント**:
- どの地域で認知度が高いか？
- どの地域で購入経験が多いか？
- 地域間でファネルの傾向にどのような違いがあるか？

---

## 8. 注意事項

### 8.1 データの解釈
1. **セグメント間の数値差異**
   - セグメントによって母集団サイズが異なるため、絶対値よりも相対的な傾向を重視
   - 小規模セグメントでは数値のブレが大きい可能性

2. **ファネル形状の比較**
   - セグメント間でファネル形状（減少傾向）が異なる場合、そのセグメント特有の課題を示唆
   - 例: 認知は高いが購入経験が低い → 購入障壁の存在

3. **セグメントの選択**
   - 比較したいセグメントを明確にする
   - 類似セグメントの比較は差異が小さく、分析価値が低い可能性

### 8.2 グラフの読み方
- **縦棒の高さ**: 各指標の数値
- **色分け**: セグメントごとに異なる色
- **並び順**: ドラッグ&ドロップで調整可能

---

## 9. 他のモードとの使い分け

### モード1とモード2の使い分け
| 観点 | モード1（セグメント固定） | モード2（ブランド固定） |
|------|-------------------------|------------------------|
| **固定軸** | セグメント（単一） | ブランド（単一） |
| **比較軸** | 複数ブランド | 複数セグメント |
| **主な用途** | 競合比較 | セグメント別分析 |
| **発見内容** | ブランド間の強み・弱み | セグメント間の強み・弱み |

### モード2とモード3の使い分け
| 観点 | モード2 | モード3 |
|------|---------|---------|
| **X軸** | ファネル6指標（固定） | 複数ブランド |
| **データ系列** | 複数セグメント | 複数セグメント |
| **主な用途** | セグメント間の総合比較 | 特定指標での詳細比較 |

---

## 10. 実装上の注意点

### 10.1 モード1との完全な対称性
モード1（セグメント固定）とモード2（ブランド固定）は、固定軸と比較軸が異なるだけで構造は完全に同じ：

| 要素 | モード1 | モード2 |
|------|---------|---------|
| フィルタ軸 | 単一セグメント | 単一ブランド |
| データ系列軸 | 複数ブランド | 複数セグメント |
| X軸 | ファネル6指標（共通） | ファネル6指標（共通） |

### 10.2 データパース処理
モード1で実装済みのデータパース処理をそのまま活用できる。

### 10.3 実装の効率化
モード1の実装をコピーし、以下の箇所のみ変更すればOK：
1. モードID: `funnel_segment_brands` → `funnel_brand_segments`
2. axes.segments.role: `'FILTER'` → `'SERIES'`
3. axes.brands.role: `'SERIES'` → `'FILTER'`
4. dataTransform.series: `'brands'` → `'segments'`
5. dataTransform.filter: `'segments'` → `'brands'`

---

## 11. まとめ

モード2「ファネル分析①（ブランド×複数セグメント）」は、特定のブランドを複数のセグメント間で比較する分析モードです。

### 主な特徴
- **6指標評価**: 認知から購入、リピートまでの全段階を可視化
- **セグメント比較**: セグメント間の違いを直感的に把握
- **セグメント戦略**: セグメント別の強み・弱みを特定
- **ファネル形状**: セグメントごとのファネル特性を可視化

### 活用シーン
- セグメント別のブランド浸透度分析
- 性年代別・地域別のパフォーマンス比較
- セグメント特化型マーケティング施策の立案
- 投資優先度の高いセグメントの特定

### モード1との補完関係
- **モード1**: セグメント内でブランドを比較
- **モード2**: ブランド内でセグメントを比較
- 両方を併用することで、多角的な分析が可能

このモードを活用することで、セグメント別のブランドパフォーマンスを詳細に評価し、効果的なセグメント戦略を立案できます。

---

**文書ステータス**: 要件定義完了  
**作成日**: 2025-11-29  
**バージョン**: 1.0

