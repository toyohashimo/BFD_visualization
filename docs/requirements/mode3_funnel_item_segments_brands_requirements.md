# モード3 - ファネル分析①（項目×複数ブランド）要件定義書

## 最終更新
2025-11-29

---

## 1. 概要

### 1.1 モード名
**モード3**: ファネル分析①（ファネル①: X=ブランド×セグメント）

### 1.2 モードID
`funnel_item_segments_brands`

### 1.3 目的
特定のファネル指標を選択し、複数のブランドを複数のセグメントで比較することで、特定指標における多角的な分析を行う。

### 1.4 参照モード
**モード1**（`funnel_segment_brands`）: ファネル分析①（セグメント固定×複数ブランド）
**モード2**（`funnel_brand_segments`）: ファネル分析①（ブランド固定×複数セグメント）

### 1.5 モード1・2との差分
| 項目 | モード1 | モード2 | モード3 |
|------|---------|---------|---------|
| **モードID** | `funnel_segment_brands` | `funnel_brand_segments` | `funnel_item_segments_brands` |
| **固定軸** | 単一セグメント | 単一ブランド | 単一ファネル指標 |
| **X軸** | ファネル6指標 | ファネル6指標 | 複数ブランド |
| **データ系列** | 複数ブランド | 複数セグメント | 複数セグメント |
| **分析視点** | 「セグメント内でブランドを比較」 | 「ブランド内でセグメントを比較」 | 「特定指標でブランド×セグメントを比較」 |
| **主な用途** | 競合比較 | セグメント別分析 | 特定指標の詳細比較 |

---

## 2. ファネル指標（FT-GL）

### 2.1 指標一覧

| 指標コード | 指標名 | Excel列 | 列インデックス | 説明 |
|:---|:---|:---|:---|:---|
| FT | 認知あり(TOP2) | M | 12 | ブランドを認知している |
| FW | 興味あり(TOP2) | P | 15 | ブランドに興味がある |
| FZ | 好意あり(TOP2) | S | 18 | ブランドに好意を持っている |
| GC | 購入・利用意向あり(TOP2) | V | 21 | 購入・利用したい |
| GJ | 購入・利用経験あり(TOP5) | AD | 29 | 購入・利用したことがある |
| GL | リピート意向あり(TOP2) | AG | 32 | また購入・利用したい |

### 2.2 各指標の詳細

#### FT: 認知あり(TOP2)
- **定義**: ブランドを認知している度合い
- **評価内容**: ブランドの知名度
- **マーケティング的意義**: 認知拡大施策の効果を測定

#### FW: 興味あり(TOP2)
- **定義**: ブランドに興味を持っている度合い
- **評価内容**: 認知から興味への転換
- **マーケティング的意義**: 興味喚起施策の効果を測定

#### FZ: 好意あり(TOP2)
- **定義**: ブランドに好意を持っている度合い
- **評価内容**: ブランドへの好感度
- **マーケティング的意義**: ブランドイメージ施策の効果を測定

#### GC: 購入・利用意向あり(TOP2)
- **定義**: 購入・利用したい度合い
- **評価内容**: 購入への意欲
- **マーケティング的意義**: コンバージョン施策の効果を測定

#### GJ: 購入・利用経験あり(TOP5)
- **定義**: 実際に購入・利用したことがある度合い
- **評価内容**: 実際の購入経験
- **マーケティング的意義**: トライアル施策の効果を測定

#### GL: リピート意向あり(TOP2)
- **定義**: また購入・利用したい度合い
- **評価内容**: リピート意欲
- **マーケティング的意義**: ロイヤリティ施策の効果を測定

---

## 3. 分析モード詳細

### 3.1 分析軸の構成
- **X軸**: 選択した複数のブランド
- **データ系列**: 選択した複数のセグメント
- **フィルタ**: ファネル指標（単一選択）

### 3.2 UI要素
- **分析項目セクション**: 【SA】バッジ表示、ドロップダウン選択（6指標から1つを選択）
- **セグメントセクション**: 【MA】バッジ表示、複数選択リスト + ドラッグ＆ドロップ
- **ブランドセクション**: 【MA】バッジ表示、複数選択リスト + ドラッグ＆ドロップ

### 3.3 デフォルトチャートタイプ
**集合縦棒グラフ**

**理由**:
- ブランド間の比較が視覚的に明確
- セグメント別の違いも色分けで識別可能
- 特定指標に焦点を当てた詳細比較に適している

---

## 4. データ要件

### 4.1 Excelファイルのフォーマット

#### 必要な列
| 列 | 列番号（0-based） | Excel列 | ヘッダー名 | 内部キー | 説明 |
|----|-----------------|---------|-----------|---------|------|
| ブランド名 | 3 | D | (任意) | - | ブランド識別子 |
| 認知あり | 12 | M | 認知あり(TOP2) | FT | ファネル指標1 |
| 興味あり | 15 | P | 興味あり(TOP2) | FW | ファネル指標2 |
| 好意あり | 18 | S | 好意あり(TOP2) | FZ | ファネル指標3 |
| 購入意向あり | 21 | V | 購入・利用意向あり(TOP2) | GC | ファネル指標4 |
| 購入経験あり | 29 | AD | 購入・利用経験あり(TOP5) | GJ | ファネル指標5 |
| リピート意向あり | 32 | AG | リピート意向あり(TOP2) | GL | ファネル指標6 |

#### データ形式
- **ヘッダー行**: 3行目
- **データ開始**: 4行目以降
- **データ型**: 数値（パーセンテージ）
- **欠損値処理**: 「-」または空白は自動的に0として処理

---

## 5. 実装仕様

### 5.1 モード設定（constants/analysisConfigs.ts）

```typescript
'funnel_item_segments_brands': {
  id: 'funnel_item_segments_brands',
  name: 'ファネル分析①（ファネル①: X=ブランド×セグメント）',
  description: '単一分析項目における複数ブランド・セグメントの比較',
  axes: {
    items: {
      role: 'FILTER',
      label: '分析項目',
      allowMultiple: false,
      itemSet: 'funnel'
    },
    segments: {
      role: 'SERIES',
      label: 'セグメント比較',
      allowMultiple: true
    },
    brands: {
      role: 'X_AXIS',
      label: 'ブランド比較',
      allowMultiple: true
    }
  },
  dataTransform: {
    xAxis: 'brands',
    series: 'segments',
    filter: 'items'
  },
  defaultChartType: 'bar'
}
```

### 5.2 型定義（types.ts）

**既存の型定義を流用**:
- `FunnelMetrics` インターフェース（FT～GL）
- `METRIC_LABELS` 定数
- `METRIC_KEYS` 配列
- `ItemSet` 型の `'funnel'`

### 5.3 データパース処理（App.tsx）

**既存の実装を流用**:
モード1・2で実装済みの以下の処理を活用：
- `funnelColMap` の定義
- `funnelLabels` の定義
- ヘッダー解析ループにファネル指標の検出ロジック
- データ行処理でファネルメトリクスの読み込み

---

## 6. ビジネス価値

### 6.1 分析の目的
1. **特定指標の詳細分析**: 特定のファネル指標に焦点を当てた詳細比較
2. **ブランド×セグメントのマトリクス分析**: 複数の軸での同時比較
3. **施策効果の詳細測定**: 特定指標に対する施策効果を詳細に測定

### 6.2 想定ユースケース

#### ユースケース1: 認知度の詳細比較
**シナリオ**: 「FT（認知あり）」指標で、自社ブランドと競合2社を、若年層・中年層・シニア層で比較

- **操作**: モード3選択 → 分析項目「FT（認知あり）」選択 → ブランド3社選択 → セグメント3つ選択
- **発見**: 自社ブランドは若年層での認知度が高いが、シニア層では競合に劣る
- **アクション**: シニア層向けの認知拡大施策を強化

#### ユースケース2: 購入経験の詳細比較
**シナリオ**: 「GJ（購入経験あり）」指標で、複数ブランドを地域別に比較

- **操作**: モード3選択 → 分析項目「GJ（購入経験あり）」選択 → ブランド4社選択 → 地域セグメント4つ選択
- **発見**: 自社ブランドは関東では強いが、関西では弱い
- **アクション**: 関西での販売促進施策を強化

#### ユースケース3: リピート意向の詳細比較
**シナリオ**: 「GL（リピート意向あり）」指標で、自社の複数ブランドを性年代別に比較

- **操作**: モード3選択 → 分析項目「GL（リピート意向あり）」選択 → 自社ブランド3つ選択 → 性年代セグメント4つ選択
- **発見**: ブランドAは男性での リピート意向が高いが、女性では低い
- **アクション**: 女性向けのロイヤリティプログラムを検討

---

## 7. 使用例

### シナリオ1: 認知度の詳細比較

**目的**: 「認知度」に焦点を当てて、ブランド×セグメントのマトリクス分析

**手順**:
1. モード3「ファネル分析①（項目×複数ブランド）」を選択
2. 分析項目「FT（認知あり）」を選択
3. ブランド「自社ブランド」「競合A」「競合B」を選択
4. セグメント「全体」「男性」「女性」を選択
5. 集合縦棒グラフで比較

**分析ポイント**:
- どのブランドがどのセグメントで認知度が高いか？
- 自社ブランドの強いセグメント・弱いセグメントはどこか？
- セグメント別の競合との差はどの程度か？

### シナリオ2: 購入意向の詳細比較

**目的**: 「購入意向」に焦点を当てて、地域別のブランド比較

**手順**:
1. モード3を選択
2. 分析項目「GC（購入意向あり）」を選択
3. ブランド「自社ブランド」「競合A」を選択
4. セグメント「関東」「関西」「中部」「九州」を選択
5. 横棒グラフに切り替えて比較

**分析ポイント**:
- どの地域で購入意向が高いか？
- 地域別の競合との差はどの程度か？
- 投資優先度の高い地域はどこか？

---

## 8. 注意事項

### 8.1 データの解釈
1. **指標の選択が重要**
   - どの指標を選択するかで分析の意味が大きく変わる
   - 分析の目的に応じて適切な指標を選択する

2. **ブランド×セグメントの組み合わせ**
   - ブランド数×セグメント数が多すぎると、グラフが見づらくなる
   - 最大でもブランド5つ×セグメント4つ程度を推奨

3. **セグメント間の数値差異**
   - セグメントによって母集団サイズが異なるため、絶対値よりも相対的な傾向を重視

### 8.2 グラフの読み方
- **X軸**: 選択したブランド
- **縦棒の高さ**: 選択した指標の数値
- **色分け**: セグメントごとに異なる色
- **並び順**: ドラッグ&ドロップで調整可能

---

## 9. 他のモードとの使い分け

### モード1・2・3の使い分け
| 観点 | モード1 | モード2 | モード3 |
|------|---------|---------|---------|
| **固定軸** | セグメント | ブランド | ファネル指標 |
| **X軸** | ファネル6指標 | ファネル6指標 | 複数ブランド |
| **データ系列** | 複数ブランド | 複数セグメント | 複数セグメント |
| **主な用途** | 総合的なブランド比較 | 総合的なセグメント比較 | 特定指標の詳細比較 |
| **分析の深さ** | 広く浅く | 広く浅く | 狭く深く |

### モード3の独自の価値
- **特定指標への集中**: 1つの指標に焦点を当てた詳細分析
- **マトリクス分析**: ブランド×セグメントの2軸分析
- **施策効果の測定**: 特定指標に対する施策効果を詳細に測定

---

## 10. 実装上の注意点

### 10.1 モード1・2との違い
| 要素 | モード1・2 | モード3 |
|------|-----------|---------|
| フィルタ軸 | セグメントまたはブランド | ファネル指標 |
| X軸 | ファネル6指標（固定） | 複数ブランド（可変） |
| データ系列軸 | ブランドまたはセグメント | 複数セグメント（可変） |

### 10.2 UI上の違い
- **分析項目セクション**: 【固定】→【SA】に変更（ドロップダウン表示）
- **ブランドセクション**: 【SERIES】→【X_AXIS】に変更（役割の変更）
- **セグメントセクション**: 【FILTER】または【SERIES】→【SERIES】に固定

### 10.3 データ変換処理
モード1・2とは異なり、X軸がブランドになるため、データ変換処理が異なる：
- `dataTransform.xAxis: 'brands'`
- `dataTransform.series: 'segments'`
- `dataTransform.filter: 'items'`

---

## 11. まとめ

モード3「ファネル分析①（項目×複数ブランド）」は、特定のファネル指標に焦点を当てた詳細分析モードです。

### 主な特徴
- **特定指標への集中**: 1つの指標を詳細に分析
- **マトリクス分析**: ブランド×セグメントの2軸分析
- **柔軟な比較**: ブランドとセグメントを自由に組み合わせ
- **詳細な施策効果測定**: 特定指標に対する施策効果を測定

### 活用シーン
- 特定指標（認知度、購入経験など）の詳細比較
- ブランド×セグメントのマトリクス分析
- 特定指標に対する施策効果の測定
- セグメント別の競合ポジショニング分析

### モード1・2との補完関係
- **モード1・2**: ファネル全体を総合的に比較（広く浅く）
- **モード3**: 特定指標を詳細に比較（狭く深く）
- 3つのモードを併用することで、多角的な分析が可能

このモードを活用することで、特定のファネル指標における詳細なブランド×セグメント分析を行い、効果的なマーケティング施策を立案できます。

---

**文書ステータス**: 要件定義完了  
**作成日**: 2025-11-29  
**バージョン**: 1.0

