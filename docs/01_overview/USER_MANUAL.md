# BFD Analytics 取扱説明書

**バージョン**: 3.0.0-beta  
**最終更新**: 2025-12-01  
**対象読者**: エンドユーザー、マーケティング担当者、データアナリスト

---

## 📋 目次

1. [はじめに](#はじめに)
2. [アプリケーション概要](#アプリケーション概要)
3. [ログイン](#ログイン)
4. [セットアップ](#セットアップ)
5. [基本的な使い方](#基本的な使い方)
6. [グローバルモードの説明](#グローバルモードの説明)
7. [詳細分析モード（14種類）](#詳細分析モード14種類)
8. [過去比較モード（6種類）](#過去比較モード6種類)
9. [Excelファイルの準備](#excelファイルの準備)
10. [機能詳細](#機能詳細)
11. [トラブルシューティング](#トラブルシューティング)
12. [よくある質問（FAQ）](#よくある質問faq)

---

## はじめに

BFD Analyticsは、Excel形式のブランドファネル調査データを可視化・分析するためのWebアプリケーションです。複雑なExcelデータを直感的なグラフとして表示し、ブランド分析業務を効率化します。

### 主な特徴

- ✅ **20種類の分析モード**: 詳細分析14種類 + 過去比較6種類
- ✅ **複数データソース対応**: 過去比較モードでは最大3つのExcelファイルを同時に読み込み可能
- ✅ **インタラクティブなグラフ**: 棒グラフ、折れ線グラフ、レーダーチャートに対応
- ✅ **データエクスポート**: CSV形式でのデータ出力、画像としてのクリップボードコピー
- ✅ **匿名化機能**: デモやプレゼンテーション時にブランド名を匿名化可能
- ✅ **ドラッグ&ドロップ**: ブランドやセグメントの並び替えが簡単

---

## アプリケーション概要

### システム要件

- **ブラウザ**: Chrome、Firefox、Safari、Edge（最新版推奨）
- **JavaScript**: 有効化されていること
- **データ**: Excelファイル（.xlsx, .xls）またはCSVファイル（.csv）

### 対応データ形式

- Excelファイル（.xlsx, .xls）
- CSVファイル（.csv）
- 3行目ヘッダー形式（詳細は後述）

---

## ログイン

### ログイン画面について

BFD Analyticsにアクセスすると、最初にログイン画面が表示されます。

#### ログイン画面の表示

- 画面中央に「BFD」という文字がグレー色で表示されます
- この画面では、キーボード入力による認証が必要です

#### ログイン方法

1. **キーボードで「branding」と入力します**
   - 入力フィールドは表示されません
   - キーボードで直接文字を入力してください
   - 入力中の文字列は点（•）でマスクされて表示されます

2. **認証成功**
   - 「branding」と入力すると、自動的にメインアプリケーション画面に遷移します
   - 認証状態は1時間有効です

#### 認証状態の管理

- **認証の有効期限**: 認証後、1時間が経過すると自動的にログアウトされます
- **認証状態の保持**: 認証後、ページをリロードしても認証状態は保持されます（1時間以内の場合）
- **再ログイン**: 認証期限が切れた場合は、再度「branding」と入力してログインしてください

#### 注意事項

- 特殊キー（Ctrl、Alt、Shift、矢印キーなど）は無視されます
- 通常の文字キーのみが入力として認識されます
- 入力バッファは最大20文字まで保持されます

---

## セットアップ

### 1. アプリケーションの起動

1. アプリケーションのURLにアクセスします
2. ログイン画面が表示されます
3. キーボードで「branding」と入力してログインします
4. ログイン後、ファイルアップロード画面が表示されます

### 2. 初回設定

初回起動時は特に設定は不要です。ログイン後、Excelファイルをアップロードするだけで分析を開始できます。

---

## 基本的な使い方

### ステップ1: Excelファイルのアップロード

#### 方法1: ドラッグ&ドロップ
1. Excelファイルをエクスプローラー（Windows）またはFinder（Mac）で開きます
2. ファイルをアプリケーションのメインエリアにドラッグ&ドロップします
3. 自動的にデータが読み込まれます

#### 方法2: ファイル選択ボタン
1. サイドバーの「ファイルを選択」ボタンをクリックします
2. ファイル選択ダイアログからExcelファイルを選択します
3. 自動的にデータが読み込まれます

### ステップ2: グローバルモードの選択

アプリケーション上部のタブから、以下のいずれかを選択します：

- **詳細分析モード**: 複数ブランド/セグメントの横断比較
- **過去比較モード**: 時系列データの推移分析

### ステップ3: 分析モードの選択

サイドバーの「分析モード」ドロップダウンから、目的に応じた分析モードを選択します。

### ステップ4: データの選択

選択した分析モードに応じて、以下のいずれかを選択します：

- **セグメント（シート）**: Excelファイル内のシートを選択
- **ブランド**: 分析対象のブランドを選択
- **分析項目**: 分析する指標を選択（モードによって異なります）

### ステップ5: グラフの確認と調整

- グラフタイプの変更（棒グラフ、折れ線グラフ、レーダーチャート）
- データラベルの表示/非表示
- Y軸の最大値調整
- カラーテーマの変更

### ステップ6: データのエクスポート（オプション）

- **CSVエクスポート**: データをCSV形式でダウンロード
- **画像コピー**: グラフを画像としてクリップボードにコピー

---

## グローバルモードの説明

BFD Analyticsは、2つのグローバルモードを提供します。それぞれのモードで分析の目的と操作方法が異なります。

### 詳細分析モード

**目的**: 複数ブランド/セグメントの横断比較

**特徴**:
- 単一のExcelファイルを使用
- ブランド・セグメントを複数選択可能（最大10個）
- 競合分析、セグメント間比較に最適

**使用例**:
- 複数のブランドを同じセグメントで比較
- 1つのブランドを複数のセグメントで比較
- 特定の指標で複数ブランドを比較

### 過去比較モード

**目的**: 時系列データの推移分析

**特徴**:
- 最大3つのExcelファイルを同時に読み込み可能
- ブランド・セグメントは単一選択
- データソース（ファイル）を複数選択して比較
- トレンド分析、時系列推移に最適

**使用例**:
- 2023年、2024年、2025年のデータを比較
- ブランドの認知度の推移を確認
- 期間ごとのブランドイメージの変化を分析

**データソース管理**:
- 各データソースに名前を付けることができます（例：「2025年6月」）
- データソースのON/OFF切り替えが可能
- 不要なデータソースを削除可能
- 全データソースを一括リセット可能

---

## 詳細分析モード（14種類）

詳細分析モードでは、単一のExcelファイルから複数のブランドやセグメントを選択して横断比較を行います。

### カテゴリーA1: ファネル分析①（3モード）

#### モード1: セグメント×複数ブランド

**目的**: 1つのセグメント内で複数ブランドを比較

**設定**:
- **分析項目**: ファネル①指標6項目（固定）
  - FT: 認知あり(TOP2)
  - FW: 興味あり(TOP2)
  - FZ: 好意あり(TOP2)
  - GC: 購入・利用意向あり(TOP2)
  - GJ: 購入・利用経験あり(TOP5)
  - GL: リピート意向あり(TOP2)
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: ファネル①指標
- データ系列: 選択した各ブランド

**使用例**: 「全体」セグメントで複数ブランドのファネル指標を比較

---

#### モード2: ブランド×複数セグメント

**目的**: 1つのブランドを複数セグメント間で比較

**設定**:
- **分析項目**: ファネル①指標6項目（固定）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: ファネル①指標
- データ系列: 選択した各セグメント

**使用例**: 「スターバックス」を男性・女性・年齢層別で比較

---

#### モード3: 項目×複数ブランド

**目的**: 特定の指標で複数ブランドを複数セグメントで比較

**設定**:
- **分析項目**: ファネル①指標から1つを選択
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: 選択した各ブランド
- データ系列: 選択した各セグメント

**使用例**: 「FT（認知あり）」指標で複数ブランドをセグメント別に比較

---

### カテゴリーA2: ファネル分析②（3モード）

#### モード4: 時系列：セグメント×複数ブランド

**目的**: 1つのセグメント内で複数ブランドの時系列項目を比較

**設定**:
- **分析項目**: ファネル②指標5項目（固定）
  - T1: 直近1ヶ月以内に購入・利用した
  - T2: 過去2～3ヶ月以内に購入・利用した
  - T3: 過去4ヶ月～半年未満に購入・利用した
  - T4: 半年～1年未満に購入・利用した
  - T5: 1年以上前に購入・利用した
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: ファネル②指標
- データ系列: 選択した各ブランド

**使用例**: 「全体」セグメントで複数ブランドの直近利用状況を比較

---

#### モード5: 時系列：ブランド×複数セグメント

**目的**: 1つのブランドの時系列項目を複数セグメントで比較

**設定**:
- **分析項目**: ファネル②指標5項目（固定）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: ファネル②指標
- データ系列: 選択した各セグメント

**使用例**: 「スターバックス」の購入時期分布をセグメント別に比較

---

#### モード6: 時系列：項目×複数ブランド

**目的**: 特定の時系列項目で複数ブランドを複数セグメントで比較

**設定**:
- **分析項目**: ファネル②指標から1つを選択
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: 選択した各ブランド
- データ系列: 選択した各セグメント

**使用例**: 「T1（直近1ヶ月以内に購入・利用）」で複数ブランドをセグメント別に比較

---

### カテゴリーA3: ブランドイメージ分析（2モード）

#### モード7: ブランド分析（セグメント×複数ブランド）

**目的**: 1つのセグメント内で複数ブランドのブランドイメージを比較

**設定**:
- **分析項目**: ブランドイメージ項目（TOP30、自動選定）
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: ブランドイメージ項目（先頭ブランドのTOP30）
- データ系列: 選択した各ブランド
- X軸ラベル: 縦方向に表示（項目数が多いため）

**特記事項**:
- デフォルトチャート: 縦棒グラフ
- 先頭ブランドが基準となりTOP30項目を自動選定
- 項目は先頭ブランドの降順で並び替えられます

**使用例**: 「全体」セグメントで複数ブランドのイメージを比較

---

#### モード8: ブランド分析（ブランド×複数セグメント）

**目的**: 1つのブランドを複数セグメント間でブランドイメージを比較

**設定**:
- **分析項目**: ブランドイメージ項目（TOP30、自動選定）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: ブランドイメージ項目（先頭セグメントでのTOP30）
- データ系列: 選択した各セグメント
- X軸ラベル: 縦方向に表示（項目数が多いため）

**特記事項**:
- デフォルトチャート: 縦棒グラフ
- 先頭セグメントが基準となりTOP30項目を自動選定

**使用例**: 「スターバックス」のイメージをセグメント別に比較

---

### カテゴリーA4: ブランドパワー分析（4モード）

#### モード9: ブランドパワー①（セグメント×複数ブランド）

**目的**: 1つのセグメント内で複数ブランドの現在パワーを比較

**設定**:
- **分析項目**: ブランドパワー指標4項目（固定）
  - BP1: 認知
  - BP2: 興味・関心
  - BP3: 購入意向
  - BP4: 推奨意向
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: ブランドパワー指標
- データ系列: 選択した各ブランド
- デフォルトチャート: レーダーチャート（4角形）

**使用例**: 「全体」セグメントで複数ブランドの現在パワーを比較

---

#### モード10: ブランドパワー①（ブランド×複数セグメント）

**目的**: 1つのブランドを複数セグメント間で現在パワーを比較

**設定**:
- **分析項目**: ブランドパワー指標4項目（固定）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: ブランドパワー指標
- データ系列: 選択した各セグメント
- デフォルトチャート: レーダーチャート（4角形）

**使用例**: 「スターバックス」の現在パワーをセグメント別に比較

---

#### モード11: ブランドパワー②（セグメント×複数ブランド）

**目的**: 1つのセグメント内で複数ブランドの将来性パワーを比較

**設定**:
- **分析項目**: 将来性パワー指標6項目（固定）
  - FP1: 目的意識
  - FP2: 社会との向き合い
  - FP3: 顧客理解力
  - FP4: 双方向コミュニケーション
  - FP5: 技術開発力
  - FP6: 自己実現サポート
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: 将来性パワー指標
- データ系列: 選択した各ブランド
- デフォルトチャート: レーダーチャート（6角形）

**使用例**: 「全体」セグメントで複数ブランドの将来性パワーを比較

---

#### モード12: ブランドパワー②（ブランド×複数セグメント）

**目的**: 1つのブランドを複数セグメント間で将来性パワーを比較

**設定**:
- **分析項目**: 将来性パワー指標6項目（固定）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: 将来性パワー指標
- データ系列: 選択した各セグメント
- デフォルトチャート: レーダーチャート（6角形）

**使用例**: 「スターバックス」の将来性パワーをセグメント別に比較

---

### カテゴリーA5: アーキタイプ分析（2モード）

#### モード13: アーキタイプ（セグメント×複数ブランド）

**目的**: 1つのセグメント内で複数ブランドのアーキタイプ（ブランドパーソナリティ）を比較

**設定**:
- **分析項目**: アーキタイプ指標12項目（固定、自動計算）
  - 12原型のブランドパーソナリティ評価
- **セグメント**: 単一選択
- **ブランド**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）

**表示形式**:
- X軸: アーキタイプ指標（12項目）
- データ系列: 選択した各ブランド
- デフォルトチャート: レーダーチャート（12角形）

**特記事項**:
- アーキタイプはブランドイメージ項目から自動計算されます
- 12タイプのブランドパーソナリティを評価します

**使用例**: 「全体」セグメントで複数ブランドのパーソナリティを比較

---

#### モード14: アーキタイプ（ブランド×複数セグメント）

**目的**: 1つのブランドを複数セグメント間でアーキタイプを比較

**設定**:
- **分析項目**: アーキタイプ指標12項目（固定、自動計算）
- **セグメント**: 複数選択（最大10個、ドラッグ&ドロップで並び替え可能）
- **ブランド**: 単一選択

**表示形式**:
- X軸: アーキタイプ指標（12項目）
- データ系列: 選択した各セグメント
- デフォルトチャート: レーダーチャート（12角形）

**使用例**: 「スターバックス」のパーソナリティをセグメント別に比較

---

## 過去比較モード（6種類）

過去比較モードでは、最大3つのExcelファイルを読み込み、時系列でのデータ推移を比較します。

### Mode 1: ファネル分析①（過去比較）

**目的**: 単一セグメント・単一ブランドのファネル①指標の時系列推移

**設定**:
- **X軸**: ファネル①指標6項目（固定）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: 縦棒グラフ

**使用例**: 「全体」セグメントの「スターバックス」について、2023年、2024年、2025年のファネル指標を比較

---

### Mode 2: ファネル分析②（過去比較）

**目的**: 単一セグメント・単一ブランドのファネル②指標の時系列推移

**設定**:
- **X軸**: ファネル②指標5項目（固定）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: 縦棒グラフ

**使用例**: 「全体」セグメントの「スターバックス」について、購入時期分布の推移を比較

---

### Mode 3: ブランドイメージ分析（過去比較）

**目的**: 単一セグメント・単一ブランドのブランドイメージの時系列推移

**設定**:
- **X軸**: ブランドイメージ項目TOP30（基準データソースの降順で自動選定）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: 縦棒グラフ

**特記事項**:
- 基準データソース（先頭のデータソース）のTOP30項目が自動選定されます
- 基準データソース警告が表示されます
- X軸ラベルは縦方向に表示されます

**使用例**: 「全体」セグメントの「スターバックス」について、ブランドイメージの推移を比較

---

### Mode 4: ブランドパワー分析①（過去比較）

**目的**: 単一セグメント・単一ブランドの現在パワーの時系列推移

**設定**:
- **X軸**: ブランドパワー指標4項目（固定）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: レーダーチャート（4角形）

**使用例**: 「全体」セグメントの「スターバックス」について、現在パワーの推移を比較

---

### Mode 5: ブランドパワー分析②（過去比較）

**目的**: 単一セグメント・単一ブランドの将来性パワーの時系列推移

**設定**:
- **X軸**: 将来性パワー指標6項目（固定）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: レーダーチャート（6角形）

**使用例**: 「全体」セグメントの「スターバックス」について、将来性パワーの推移を比較

---

### Mode 6: アーキタイプ分析（過去比較）

**目的**: 単一セグメント・単一ブランドのアーキタイプの時系列推移

**設定**:
- **X軸**: アーキタイプ指標12項目（固定、自動計算）
- **データ系列**: 各データソース（最大3つ）
- **セグメント**: 単一選択
- **ブランド**: 単一選択
- **デフォルトチャート**: レーダーチャート（12角形）

**使用例**: 「全体」セグメントの「スターバックス」について、ブランドパーソナリティの推移を比較

---

### 過去比較モードのデータソース管理

過去比較モードでは、最大3つのExcelファイルを同時に読み込むことができます。

#### データソースの追加

1. サイドバーの「データソース管理」エリアで「ファイルを選択」ボタンをクリック
2. Excelファイルを選択
3. ファイル名から自動的にデータソース名が抽出されます（例：`BFD_202506.xlsx` → 「2025年6月」）
4. データソース名は編集可能です

#### データソースのON/OFF切り替え

- 各データソースの左側にあるチェックボックスでON/OFFを切り替えられます
- OFFにしたデータソースはグラフに表示されません

#### データソースの削除

- 各データソースの右側にある「×」ボタンをクリックして削除できます

#### 全データソースのリセット

- 「リセット」ボタンをクリックすると、すべてのデータソースが削除されます
- 確認ダイアログが表示されます

---

## Excelファイルの準備

### ファイル形式

- **対応形式**: Excelファイル（.xlsx, .xls）またはCSVファイル（.csv）
- **推奨形式**: .xlsx

### ファイル構造

Excelファイルは以下の構造に従う必要があります：

#### 行の構成

| 行番号 | 役割 | 説明 |
|:---:|:---|:---|
| **1** | **カテゴリ行** | 各列のカテゴリ名（例：「現在パワー項目構成要素」「共通68イメージ」） |
| **2** | **項目名行** | 各列の項目名（例：「認知あり」「ブランドイメージ」） |
| **3** | **ヘッダー行** | 各列の詳細項目名（実際のヘッダーとして使用） |
| **4以降** | **データ行** | 各ブランドの指標データが格納されます |

#### 必須列

| 列（Excel） | インデックス | 項目名 | 説明 |
|:---:|:---:|:---|:---|
| **D** | 3 | ブランド名 | この列の値がブランドの識別子として使用されます |

#### 指標列

以下のヘッダー名を持つ列が検索され、対応する指標としてマッピングされます。列の位置は固定ではなく、ヘッダー名の一致によって特定されます。

##### ファネル指標（必須）

| ヘッダー名（完全一致） | 内部キー | 説明 |
|:---|:---:|:---|
| `認知あり(TOP2)` | `FT` | 認知率 |
| `興味あり(TOP2)` | `FW` | 興味・関心率 |
| `好意あり(TOP2)` | `FZ` | 好意度 |
| `購入・利用意向あり(TOP2)` | `GC` | 購入意向 |
| `購入・利用経験あり(TOP5)` | `GJ` | 購入経験 |
| `リピート意向あり(TOP2)` | `GL` | リピート意向 |

> **注意**: `認知あり(TOP2)` (FT) の列が存在しない場合、そのシートのデータは無効とみなされスキップされます。

##### 時系列指標（オプション）

| ヘッダー名（完全一致） | 内部キー | 説明 |
|:---|:---:|:---|
| `直近1ヶ月以内に購入・利用した` | `T1` | 直近1ヶ月 |
| `過去2～3ヶ月以内に購入・利用した` | `T2` | 過去2～3ヶ月 |
| `過去4ヶ月～半年未満に購入・利用した` | `T3` | 過去4ヶ月～半年 |
| `半年～1年未満に購入・利用した` | `T4` | 半年～1年 |
| `1年以上前に購入・利用した` | `T5` | 1年以上前 |

##### ブランドイメージ指標（オプション）

ブランドイメージ項目は、**パターンマッチング方式**で動的に抽出されます。

| 抽出方法 | 説明 |
|:---|:---|
| **パターンマッチング** | 行1（2行目）に「ブランドイメージ」を含む列を自動検索 |
| **ヘッダー行** | 行2（3行目）から実際の項目名を取得 |
| **除外キーワード** | 「あてはまるものはない」を含む項目は自動除外 |

> **注意**: 
> - ブランドイメージ項目は列位置に依存せず、行1（2行目）の項目名に「ブランドイメージ」を含む列を自動的に検出します
> - ファイルごとに列数が異なっても（例：202406ファイルは207列、202506ファイルは195列）自動的に対応可能です
> - 実際の項目名は行2（3行目）のヘッダーから取得されます

##### ブランドパワー指標（オプション）

| ヘッダー名（完全一致） | 内部キー | 説明 |
|:---|:---:|:---|
| `認知` | `BP1` | 認知 |
| `興味・関心` | `BP2` | 興味・関心 |
| `購入意向` | `BP3` | 購入意向 |
| `推奨意向` | `BP4` | 推奨意向 |

##### 将来性パワー指標（オプション）

| ヘッダー名（完全一致） | 内部キー | 説明 |
|:---|:---:|:---|
| `目的意識` | `FP1` | 目的意識 |
| `社会との向き合い` | `FP2` | 社会との向き合い |
| `顧客理解力` | `FP3` | 顧客理解力 |
| `双方向コミュニケーション` | `FP4` | 双方向コミュニケーション |
| `技術開発力` | `FP5` | 技術開発力 |
| `自己実現サポート` | `FP6` | 自己実現サポート |

> **注意**: Excelヘッダーに改行（`\n`, `\r\n`）が含まれている場合でも、自動的に処理されます。

### データのバリデーション

以下の条件を満たさないシートは読み込み時に無視、またはエラーとなります。

1. **データ行数**: 全体の行数が4行未満の場合、スキップされます
2. **必須指標**: `認知あり(TOP2)` の列が見つからない場合、スキップされます
3. **ブランド名**: D列（インデックス3）に値が存在しない行はスキップされます
4. **有効データ**: 有効なブランドデータが1つも見つからない場合、エラーメッセージが表示されます

---

## 機能詳細

### グラフタイプの切り替え

アプリケーション上部のアイコンバーから、以下のグラフタイプを選択できます：

- **縦棒グラフ**: カテゴリごとの値を比較
- **横棒グラフ**: 縦棒グラフを横にした表示
- **折れ線グラフ**: 時系列データやトレンドの表示に適しています
- **レーダーチャート**: 複数の指標を同時に比較（ブランドパワー、アーキタイプ分析に最適）

### データラベルの表示/非表示

- グラフ上の各データポイントに数値を表示するかどうかを切り替えられます
- サイドバーの「データラベル表示」トグルスイッチで制御します

### Y軸の最大値調整

- サイドバーの「Y軸最大値」入力欄で、Y軸の最大値を手動で設定できます
- 「自動スケール」をONにすると、データに応じて自動的に調整されます

### カラーテーマの変更

- サイドバーの「カラーテーマ」ドロップダウンから、10種類のカラーテーマを選択できます
- 各テーマは異なる色の組み合わせを提供します

### ドラッグ&ドロップによる並び替え

- 詳細分析モードでは、選択したブランドやセグメントをドラッグ&ドロップで並び替えることができます
- 並び替えた順序はグラフの表示順序に反映されます

### CSVエクスポート

1. サイドバーの「CSVエクスポート」ボタンをクリック
2. 現在表示されているグラフのデータがCSV形式でダウンロードされます
3. ExcelやGoogleスプレッドシートで開いて編集できます

### 画像コピー

1. アプリケーション上部のアイコンバーから、以下のいずれかを選択：
   - **グラフのみ**: グラフだけをクリップボードにコピー
   - **グラフ+データ**: グラフとデータテーブルの両方をクリップボードにコピー
2. クリップボードにコピーされた画像は、PowerPointやWordなどに貼り付けることができます

### 匿名化機能（デモモード）

**目的**: 実データを隠すための機能

**動作**:
- ONの場合、ブランド名を「ブランド1, ブランド2...」のようにマスキングします
- このマスキングは、画面上の表示だけでなく、CSVエクスポートされたデータにも適用されます

**起動方法**:
- サイドバーヘッダー領域（"BFD Analytics" ロゴ部分）をクリック

**視覚的フィードバック**:
- ON時: 「DEMO」バッジと `EyeOff` アイコンを表示
- OFF時: アイコンのみ（ホバー時）

**使用例**:
- クライアントへのプレゼンテーション時
- デモンストレーション時
- 機密データの保護

### データの永続化

- ユーザーの選択状態（分析モード、対象ブランド、選択セグメント等）はブラウザの `localStorage` に自動的に保存されます
- 次回アクセス時に、前回の設定が自動的に復元されます
- ブラウザのキャッシュをクリアすると、保存された設定も削除されます

---

## トラブルシューティング

### ログインできない

**原因と対処法**:

1. **キーワードの入力方法**
   - 「branding」と正確に入力してください（大文字・小文字は区別されません）
   - 入力フィールドは表示されませんが、キーボードで直接入力してください
   - 特殊キー（Ctrl、Alt、Shift、矢印キーなど）は無視されます

2. **認証期限が切れている**
   - 認証後1時間が経過すると自動的にログアウトされます
   - 再度「branding」と入力してログインしてください

3. **ブラウザのキャッシュ**
   - ブラウザのキャッシュをクリアしてから再度試してください
   - 開発者ツール（F12）で「Application」→「Local Storage」を確認し、`bfd_authenticated` を削除してから再ログインしてください

### グラフが表示されない

**原因と対処法**:

1. **データが読み込まれていない**
   - Excelファイルが正しくアップロードされているか確認してください
   - ファイル形式が正しいか確認してください（.xlsx, .xls, .csv）

2. **必須の指標が不足している**
   - `認知あり(TOP2)` の列が存在するか確認してください
   - Excelファイルの構造が正しいか確認してください

3. **ブランドやセグメントが選択されていない**
   - サイドバーでブランドやセグメントが選択されているか確認してください
   - 過去比較モードでは、データソースがONになっているか確認してください

4. **ブラウザの互換性**
   - 最新版のChrome、Firefox、Safari、Edgeを使用してください
   - JavaScriptが有効になっているか確認してください

### Excelファイルが読み込めない

**原因と対処法**:

1. **ファイル形式の問題**
   - .xlsx形式で保存されているか確認してください
   - 古い.xls形式の場合は、.xlsxに変換してください

2. **ファイル構造の問題**
   - 3行目がヘッダー行になっているか確認してください
   - D列にブランド名が含まれているか確認してください

3. **ファイルサイズの問題**
   - ファイルサイズが大きすぎる場合は、データを分割してください
   - 推奨: 1ファイルあたり10MB以下

### データが正しく表示されない

**原因と対処法**:

1. **ヘッダー名の不一致**
   - ヘッダー名が完全一致しているか確認してください（例：「認知あり(TOP2)」）
   - 余分なスペースや改行が含まれていないか確認してください

2. **データ型の問題**
   - 数値データが文字列として入力されていないか確認してください
   - 数値以外の文字（`-`, `N/A`など）は0として扱われます

3. **ブランド名の表記ゆれ**
   - 同じブランドでも表記が異なる場合、別のブランドとして扱われます
   - ブランド名を統一してください

### 過去比較モードでデータソースが表示されない

**原因と対処法**:

1. **データソースがOFFになっている**
   - 各データソースの左側のチェックボックスがONになっているか確認してください

2. **データソースが削除されている**
   - データソースが誤って削除されていないか確認してください
   - 必要に応じて再度ファイルを読み込んでください

3. **ファイル名の自動抽出が失敗している**
   - データソース名を手動で編集できます
   - ファイル名に日付情報が含まれていると、自動的に抽出されます

### パフォーマンスの問題

**原因と対処法**:

1. **大量のデータ**
   - 選択するブランドやセグメントの数を減らしてください（最大10個）
   - 過去比較モードでは、不要なデータソースをOFFにしてください

2. **ブラウザのキャッシュ**
   - ブラウザのキャッシュをクリアしてください
   - ページを再読み込みしてください

---

## よくある質問（FAQ）

### Q1: ログイン方法を教えてください

**A**: アプリケーションにアクセスすると、ログイン画面が表示されます。キーボードで「branding」と入力すると、自動的にメインアプリケーション画面に遷移します。入力フィールドは表示されませんが、キーボードで直接入力してください。入力中の文字列は点（•）でマスクされて表示されます。

### Q2: 認証状態はどのくらい保持されますか？

**A**: 認証状態は1時間有効です。1時間経過すると自動的にログアウトされ、再度ログインが必要になります。ただし、ページをリロードしても認証状態は保持されます（1時間以内の場合）。

### Q3: ログアウトする方法はありますか？

**A**: 現在の実装では、自動ログアウト（1時間経過時）のみです。手動でログアウトする場合は、ブラウザの開発者ツール（F12）で「Application」→「Local Storage」を開き、`bfd_authenticated` と `bfd_auth_timestamp` を削除してください。

### Q4: 複数のExcelファイルを同時に分析できますか？

**A**: はい、過去比較モードでは最大3つのExcelファイルを同時に読み込むことができます。詳細分析モードでは、1つのExcelファイルのみを使用します。

### Q5: ブランド名を変更できますか？

**A**: いいえ、ブランド名はExcelファイルのD列から自動的に読み込まれます。ブランド名を変更する場合は、Excelファイルを編集してください。

### Q6: グラフを画像として保存できますか？

**A**: はい、アプリケーション上部のアイコンバーから「グラフのみ」または「グラフ+データ」を選択して、クリップボードにコピーできます。その後、PowerPointやWordなどに貼り付けることができます。

### Q7: CSVエクスポートしたデータを編集できますか？

**A**: はい、CSVファイルはExcelやGoogleスプレッドシートで開いて編集できます。

### Q8: データはサーバーに送信されますか？

**A**: いいえ、すべてのデータ処理はブラウザ内で完結します。データがサーバーに送信されることはありません。

### Q9: ブランドイメージ項目のTOP30はどのように選定されますか？

**A**: 詳細分析モードでは、選択したブランドの先頭（一番上）が基準となり、そのブランドの降順でTOP30項目が自動選定されます。過去比較モードでは、基準データソース（先頭のデータソース）の降順でTOP30項目が自動選定されます。

### Q10: アーキタイプ分析の12タイプとは何ですか？

**A**: アーキタイプは、ブランドイメージ項目から自動計算される12種類のブランドパーソナリティです。詳細は、アーキタイプ分析の要件定義書を参照してください。

### Q11: 過去比較モードでデータソース名を変更できますか？

**A**: はい、各データソース名の右側にある編集ボタンをクリックして、名前を変更できます。

### Q12: データが保存されますか？

**A**: はい、ユーザーの選択状態（分析モード、対象ブランド、選択セグメント等）はブラウザの `localStorage` に自動的に保存されます。ただし、Excelファイルのデータ自体は保存されません。

### Q13: モバイルデバイスで使用できますか？

**A**: はい、モバイルデバイスでも使用できますが、画面サイズが小さいため、デスクトップでの使用を推奨します。

---

## サポート

### ドキュメント

- [README.md](../README.md) - プロジェクト概要と基本的な使い方
- [仕様書](requirements/specification.md) - 各分析モードの詳細
- [Excelフォーマット説明](requirements/sample_excel_structure.md) - データの準備方法
- [変更履歴](changelog/CHANGELOG.md) - 最新の変更内容

### トラブルシューティング

問題が解決しない場合は、以下のドキュメントを参照してください：

- [グラフが表示されない問題の解決](troubleshooting/troubleshooting_graph_not_showing.md)
- [エラー修正報告](troubleshooting/ERROR_FIX_REPORT.md)

---

**最終更新**: 2025-12-01  
**バージョン**: 3.1.0-beta  
**作成者**: AI Assistant

